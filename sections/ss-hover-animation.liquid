<div class="section-{{ section.id }} hover-controller-{{ section.id }}">
</div>

<style>
  .hover-zoom img,
  .hover-zoom svg {
    transition: transform 0.4s ease, filter 0.4s ease;
  }
  
  .hover-zoom img:hover,
  .hover-zoom svg:hover {
    transform: scale(1.1);
  }
  
  .hover-lift img,
  .hover-lift svg {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  
  .hover-lift img:hover,
  .hover-lift svg:hover {
    transform: translateY(-10px);
  }
  
  .hover-glow img,
  .hover-glow svg {
    transition: filter 0.3s ease, transform 0.3s ease;
  }
  
  .hover-glow img:hover,
  .hover-glow svg:hover {
    filter: brightness(1.2) drop-shadow(0 0 20px rgba(255, 255, 255, 0.5));
    transform: scale(1.05);
  }

  .hover-point-zoom img,
  .hover-point-zoom svg {
    transition: all 0.25s ease 0s;
  }

  .hover-blur-zoom img,
  .hover-blur-zoom svg {
    transform: scale(1.25);
    filter: blur(2px);
    transition: all 0.8s ease 0s;
  }

  .hover-blur-zoom img:hover,
  .hover-blur-zoom svg:hover {
    transform: scale(1);
    filter: blur(0px);
    transition: all 0.8s ease 0s;
  }

  .hover-point-zoom img:hover,
  .hover-point-zoom svg:hover {
    transition: all 0.25s ease 0s;
    transform: scale(2);
  }

  .hover-colorize img,
  .hover-colorize svg {
    filter: grayscale(100%);
    transition: 1s ease-in-out;
  }

  .hover-colorize img:hover,
  .hover-colorize svg:hover {
    filter: grayscale(0%);
    transform: scale(1.2);
    transition: 1s ease-in-out;
  }

  .hover-flip img,
  .hover-flip svg {
    transition: 1s ease-in-out;
    transform-style: preserve-3d;
  }

  .hover-flip img:hover,
  .hover-flip svg:hover {
    transition: 1s ease-in-out;
    transform: rotateY(180deg);
  }

  .hover-rotate-scale img,
  .hover-rotate-scale svg {
    transition: 1s ease-in-out;
  }

  .hover-rotate-scale img:hover,
  .hover-rotate-scale svg:hover {
    transform: rotate(10deg) scale(1.25);
    transition: 1s ease-in-out;
  }
  
  .hover-rotate img,
  .hover-rotate svg {
    transition: transform 0.5s ease;
  }
  
  .hover-brightness img,
  .hover-brightness svg {
    filter: brightness(50%);
    transition: all 0.5s ease 0s;
  }

  .hover-brightness img:hover,
  .hover-brightness svg:hover {
    filter: brightness(100%);
    transition: all 0.5s ease 0s;
  }

  .hover-rotate img:hover,
  .hover-rotate svg:hover {
    transform: rotate(360deg);
  }
  
  .hover-slide img,
  .hover-slide svg {
    transition: transform 0.3s ease;
  }
  
  .hover-slide img:hover,
  .hover-slide svg:hover {
    transform: translateX(10px);
  }
  
  .hover-bounce img,
  .hover-bounce svg {
    transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  }
  
  .hover-bounce img:hover,
  .hover-bounce svg:hover {
    transform: scale(1.1);
  }
  
  .hover-grayscale img,
  .hover-grayscale svg {
    transition: filter 0.3s ease, transform 0.3s ease;
    filter: grayscale(100%);
  }
  
  .hover-grayscale img:hover,
  .hover-grayscale svg:hover {
    filter: grayscale(0%);
    transform: scale(1.05);
  }
  
  .hover-sepia img,
  .hover-sepia svg {
    transition: filter 0.3s ease, transform 0.3s ease;
    filter: sepia(0%);
  }
  
  .hover-sepia img:hover,
  .hover-sepia svg:hover {
    filter: sepia(80%);
    transform: scale(1.05);
  }
</style>

<script>
  function initHoverEffects{{ section.id | replace: '-', '' }}() {
    const currentContainer = document.querySelector('.hover-controller-{{ section.id }}');
    const currentSectionElement = currentContainer ? currentContainer.closest('.shopify-section') : null;

    if (!currentSectionElement) {
        return; 
    }

    const effectScope = '{{ section.settings.effect_scope }}';
    const effectType = '{{ section.settings.effect_type }}';
    const minSize = {{ section.settings.min_size }};
    const maxSize = {{ section.settings.max_size }};

    function getSizeOfElement(element) {
      const rect = element.getBoundingClientRect();
      return Math.max(rect.width, rect.height);
    }

    function applyHoverEffect(element) {
      const size = getSizeOfElement(element);
      
      if (size >= minSize && size <= maxSize) {
        const parent = element.parentElement;
        if (!parent.classList.contains(`hover-${effectType}`)) {
          parent.classList.add(`hover-${effectType}`);
        }
      }
    }

    function processSection(section) {
      const images = section.querySelectorAll('img');
      const svgs = section.querySelectorAll('svg');
      
      images.forEach(img => {
        if (img.complete) {
          applyHoverEffect(img);
        } else {
          img.addEventListener('load', () => applyHoverEffect(img));
        }
      });
      
      svgs.forEach(svg => applyHoverEffect(svg));
    }

    let sectionsToProcess = [];
    
    switch(effectScope) {
      case 'all':
        sectionsToProcess = Array.from(document.querySelectorAll('.shopify-section'));
        break;
        
      case 'all_below':
        let sectionBelow = currentSectionElement.nextElementSibling;
        while (sectionBelow) {
          if (sectionBelow.classList.contains('shopify-section')) {
            sectionsToProcess.push(sectionBelow);
          }
          sectionBelow = sectionBelow.nextElementSibling;
        }
        break;
        
      case 'one_below':
        let nextSection = currentSectionElement.nextElementSibling;
        while (nextSection) {
          if (nextSection.classList.contains('shopify-section')) {
            sectionsToProcess.push(nextSection);
            break;
          }
          nextSection = nextSection.nextElementSibling;
        }
        break;
    }

    sectionsToProcess.forEach(section => processSection(section));

    const observerConfig = { childList: true, subtree: true };
    const observer = new MutationObserver((mutations) => {
      mutations.forEach(mutation => {
        mutation.addedNodes.forEach(node => {
          if (node.nodeType === 1) {
            if (node.tagName === 'IMG' || node.tagName === 'SVG') {
              applyHoverEffect(node);
            }
            const imgs = node.querySelectorAll?.('img, svg');
            imgs?.forEach(el => applyHoverEffect(el));
          }
        });
      });
    });

    sectionsToProcess.forEach(section => observer.observe(section, observerConfig));
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initHoverEffects{{ section.id | replace: '-', '' }});
  } else {
    initHoverEffects{{ section.id | replace: '-', '' }}();
  }

  if (Shopify.designMode) {
    document.addEventListener('shopify:section:load', function(event) {
      if (event.detail.sectionId === '{{ section.id }}') {
        initHoverEffects{{ section.id | replace: '-', '' }}();
      }
    });
  }
</script>

{% schema %}
  {
    "name": "SS - Hover animation",
    "settings": [
      {
        "type": "paragraph",
        "content": "✨ Add beautiful hover effects to images and SVG elements on your site."
      },
      {
        "type": "header",
        "content": "Effect scope"
      },
      {
        "type": "radio",
        "id": "effect_scope",
        "label": "Where to apply effects",
        "options": [
          {
            "value": "all",
            "label": "All sections on page"
          },
          {
            "value": "all_below",
            "label": "All sections below this"
          },
          {
            "value": "one_below",
            "label": "One section below this"
          }
        ],
        "default": "all"
      },
      {
        "type": "header",
        "content": "Effect settings"
      },
      {
        "type": "select",
        "id": "effect_type",
        "label": "Effect type",
        "options": [
          {
            "value": "zoom",
            "label": "Zoom - scale up"
          },
          {
            "value": "lift",
            "label": "Lift"
          },
          {
            "value": "glow",
            "label": "Glow - brightness and glow"
          },
          {
            "value": "rotate",
            "label": "Rotate - full 360° spin"
          },
           {
            "value": "brightness",
            "label": "Brightness"
          }, 
          {
            "value": "flip",
            "label": "Flip"
          },     
          {
            "value": "point-zoom",
            "label": "Point zoom"
          },  
          {
            "value": "blur-zoom",
            "label": "Blur zoom"
          },            
          {
            "value": "rotate-scale",
            "label": "Rotate and scale"
          },
          {
            "value": "colorize",
            "label": "Colorize"
          },
          {
            "value": "slide",
            "label": "Slide - move to right"
          },
          {
            "value": "bounce",
            "label": "Bounce - elastic scale"
          },
          {
            "value": "grayscale",
            "label": "Grayscale - color on hover"
          },
          {
            "value": "sepia",
            "label": "Sepia - sepia tone on hover"
          }
        ],
        "default": "zoom"
      },
      {
        "type": "header",
        "content": "Size filter"
      },
      {
        "type": "range",
        "id": "min_size",
        "min": 50,
        "max": 500,
        "step": 50,
        "unit": "px",
        "label": "Minimum size",
        "info": "Effect only applies to elements larger than this size",
        "default": 100
      },
      {
        "type": "range",
        "id": "max_size",
        "min": 500,
        "max": 2000,
        "step": 100,
        "unit": "px",
        "label": "Maximum size",
        "info": "Effect only applies to elements smaller than this size",
        "default": 1000
      }
    ],
    "presets": [
      {
        "name": "SS - Hover animation"
      }
    ]
  }
{% endschema %}