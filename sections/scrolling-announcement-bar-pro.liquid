<style>
  {{ section.settings.ss_font_family | font_face: font_display: 'swap' }}

  .ss-announcement-bar,
  .ss-announcement-bar__message {
    overflow: hidden;
  }
  .ss-announcement-bar:hover {
    opacity: {{ section.settings.hover_opacity | divided_by: 100.0 }};
  }
  .ss-announcement-bar__link {
    display: block;
    width: 100%;
    padding: {{ section.settings.padding_vertical }}rem {{section.settings.padding_horizontal}}rem;
    text-decoration: none;
    color: var(--text-color);
    line-height:0;
  }
  .ss-announcement-bar__link:hover {
    color: var(--text-color);
  }
  #marq {
    width: 100%;
    border: inset;
    overflow: hidden;
    white-space: nowrap;
    box-shadow: unset;
    border: 0;
    box-shadow: unset;
    border-color: currentcolor;
    vertical-align: middle;
  }
  {% if section.settings.animation_direction == "left" %}
  @keyframes marquesina-{{ section.id }} {
    from {
      transform: translateX(0%);
    }
    to {
      transform: translateX(-50%);
    }
  }
  @keyframes marquesina-reverse-{{ section.id }} {
    from {
      transform: translateX(50%);
    }
    to {
      transform: translateX(0%);
    }
  }
  {% else %}
  @keyframes marquesina-{{ section.id }} {
    from {
      transform: translateX(-50%);
    }
    to {
      transform: translateX(0%);
    }
  }
  @keyframes marquesina-reverse-{{ section.id }} {
    from {
      transform: translateX(0%);
    }
    to {
      transform: translateX(50%);
    }
  }
  {% endif %}
  .ss-announcement-bar-{{ section.id }} #orig {
    display: inline-block;
    overflow: hidden;
    transform: translate(0);
  }

  .ss-announcement-bar__message {
    text-align: center;
    padding: 0;
    margin: 0;
    line-height: 1;
    font-size: {{section.settings.text_size}}px;
  }
  #orig.reverse .announcement-bar__message {
    display: flex;
    flex-direction: row-reverse;
  }
  .ss-announcement-bar__message li {

    line-height: 1;
    font-size: {{section.settings.text_size}}px;
    display: inline-block;
    padding-right: 114px;
    position: relative;

  }
  .ss-announcement-bar__message li::after {
    content: '';
    width: 3.5px;
    height: 3.5px;
    background-color: var(--text-color);
    background-image: none;
    opacity: 0.3;
    border-radius: 50%;
    position: absolute;
    top: 40%;
    right: 50px;
  }
  @media (max-width: 480px) {
    #marq {
      max-height: 39px;
    }
    .ss-announcement-bar__message li {
      padding-right: 55px;
    }
    .ss-announcement-bar__message li::after {
      right: 25px;
    }
  }
  .ss-announcement-bar-{{ section.id }} #orig {
    animation: marquesina-{{ section.id }} var(--animation-duration, 45s) infinite normal linear 1s;
  }

  .ss-announcement-bar-{{ section.id }} #orig.reverse {
   animation: marquesina-reverse-{{ section.id }} var(--animation-duration, 45s) infinite normal linear 2s;
  }
</style>

{% if section.settings.pause_hover %}
  <style>
    .ss-announcement-bar:hover #orig {
      animation-play-state: paused
    }
  </style>
{% endif %}

{% if section.settings.text_custom %}
  <style>
    .ss-announcement-bar__message {
      font-family: {{section.settings.ss_font_family.family}};
      font-weight: {{section.settings.ss_font_family.weight}};
    }

    .ss-announcement-bar__message li {
      font-family: {{section.settings.ss_font_family.family}};
      font-weight: {{section.settings.ss_font_family.weight}};
    }
  </style>
{% endif %}

<template id="marquee-announcement-bar-{{ section.id }}">
  <div
    class="ss-announcement-bar ss-announcement-bar-{{ section.id }}"
    aria-label="Announcement"
    style="background-color: {{ section.settings.bg }}; --text-color: {{ section.settings.text_color }}; --animation-duration: {{ section.settings.animation_duration }}s;"
  >
    {%- if section.settings.link != blank -%}
      <a
        href="{{ section.settings.link }}"
        style="cursor: pointer;"
      >
    {% endif %}
    <div class="ss-announcement-bar__link">
      <div class="" id="marq">
        <span id="orig">
          <ul class="ss-announcement-bar__message">
            {% if section.blocks > 1 %}
              {% for i in (1..6) %}
                {% for block in section.blocks %}
                  <li>{{ block.settings.text }}</li>
                {% endfor %}
              {% endfor %}

              {% for block in section.blocks limit: 1 %}
                <!-- <li>{{ block.settings.text }}</li> -->
              {% endfor %}
            {% else %}
              {% for i in (1..12) %}
                {% for block in section.blocks %}
                  <li>{{ block.settings.text }}</li>
                {% endfor %}
              {% endfor %}

              {% for block in section.blocks limit: 1 %}
                <!-- <li>{{ block.settings.text }}</li> -->
              {% endfor %}
            {% endif %}
          </ul>
        </span>
      </div>
    </div>
    {%- if section.settings.link != blank -%}</a>{% endif %}
  </div>
</template>

<div id="marquee-local-target-{{ section.id }}"></div>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    let cssTarget = '{{ section.settings.insert_css_class_target }}';
    let productForm = cssTarget
      ? document.querySelector(cssTarget)
      : document.querySelector('#marquee-local-target-{{ section.id }}');

    if (!productForm) return;

    const templateContent = document.querySelector(
      '#marquee-announcement-bar-{{ section.id }}'
    ).content;

    productForm.insertAdjacentElement(
      'beforebegin',
      templateContent.firstElementChild
    );

    setTimeout(()=> {
      var htmlElement = document.documentElement;

      if (window.getComputedStyle(htmlElement).getPropertyValue('direction') === 'rtl') {
          document.querySelector('#orig').classList.add('reverse');
      }
    }, 1000);
  });
</script>

{% schema %}
{
  "name": "SS - Scrolling ann bar",
  "settings": [
    {
      "type": "header",
      "content": "‚ö†Ô∏è Save section to see live"
    },
    {
      "type": "text",
      "id": "insert_css_class_target",
      "label": "Target CSS class",
      "default": ".header, .pageheader, .section-header, #announcement, .toolbar, .header__wrapper",
      "placeholder": ".header, .pageheader",
      "info": "Empty text field this to display where you drag it. If you want to display the announcement bar in a specific place, you can add the CSS class of the target element here. Default is above header as announcement bar."
    },
    {
      "type": "header",
      "content": "Text"
    },   
    {
      "type": "checkbox",
      "id": "text_custom",
      "label": "Use custom font",
      "default": false
    },
    {
      "type": "font_picker",
      "id": "ss_font_family",
      "label": "Font family",
      "default": "montserrat_n4",
      "visible_if": "{{ section.settings.text_custom }}"
    },
    {
        "type": "range",
        "id": "text_size",
        "label": "Font size",
        "default": 12,
        "min": 8,
        "max": 50,
        "step": 1,
        "unit": "px"
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "url",
      "id": "link",
      "label": "Link"
    },
    {
      "type": "header",
      "content": "Animation"
    },
    {
      "type": "range",
      "id": "animation_duration",
      "label": "Scrolling speed",
      "info": "üêá ‚Äî‚Äî‚Äî‚óè‚Äî‚Äî‚Äî üê¢",
      "min": 10,
      "max": 200,
      "step": 2,
      "default": 44
    },
    {
      "type": "select",
      "id": "animation_direction",
      "label": "Direction",
      "default": "right",
      "options": [
        {
          "label": "Left",
          "value": "left"
        },
        {
          "label": "Right",
          "value": "right"
        }
      ]
    },
    {
      "type": "checkbox",
      "id": "pause_hover",
      "label": "Pause on hover",
      "default": false
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "bg",
      "label": "Background",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "hover_opacity",
      "label": "Background color hover opacity",
      "unit": "%",
      "min": 0,
      "max": 100,
      "step": 1,
      "default": 90
    },
    {
      "type": "header",
      "content": "Padding"
    },
    {
      "type": "range",
      "id": "padding_vertical",
      "label": "Vertical",
      "unit": "rem",
      "min": 0,
      "max": 5,
      "step": 0.1,
      "default": 1.5
    },
    {
      "type": "range",
      "id": "padding_horizontal",
      "label": "Sides",
      "unit": "rem",
      "min": 0,
      "max": 5,
      "step": 0.2,
      "default": 0
    }
  ],
  "presets": [
    {
      "category": "Custom",
      "name": "SS - Scrolling announcement bar",
      "blocks": [
        {
          "type": "text",
          "settings":{
            "text":"Free Shipping"
          }
        },
        {
          "type": "text",
           "settings":{
            "text":"Free Returns"
          }
        }
      ]
    }
  ],
  "max_blocks": 6,
  "blocks": [
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Text",
          "default": "Text"
        }
      ]
    }
  ]
}
{% endschema %}
