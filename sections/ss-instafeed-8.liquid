{% comment %}
---------------------------------------------------------
Copyright © 2023 Section Store. All rights reserved.
Unauthorized copying, modification, distribution, or use
of this code or any portion of it, is strictly prohibited.
Violators will be prosecuted to the fullest extent of the law.
For inquiries or permissions, contact daniel@section.store
---------------------------------------------------------
{% endcomment %}

<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
/>

{%- liquid 
  assign padding_horizontal = section.settings.padding_horizontal
  assign padding_horizontal_mobile = section.settings.padding_horizontal_mobile
  assign padding_top = section.settings.padding_top
  assign padding_bottom = section.settings.padding_bottom
  assign border_color = section.settings.border_color
  assign border_thickness = section.settings.border_thickness
  assign margin_top = section.settings.margin_top
  assign margin_bottom = section.settings.margin_bottom
  assign margin_horizontal_mobile = section.settings.margin_horizontal_mobile
  assign margin_horizontal = section.settings.margin_horizontal
  assign background_color = section.settings.background_color
  assign background_gradient = section.settings.background_gradient
  assign full_width = section.settings.full_width
  assign content_width = section.settings.content_width
  assign lazy = section.settings.lazy
  assign section_radius = section.settings.section_radius

  assign heading = section.settings.heading
  assign heading_size = section.settings.heading_size
  assign heading_size_mobile = section.settings.heading_size_mobile
  assign heading_color = section.settings.heading_color
  assign heading_custom = section.settings.heading_custom
  assign heading_font = section.settings.heading_font
  assign heading_height = section.settings.heading_height
  assign heading_align = section.settings.heading_align
  assign heading_align_mobile = section.settings.heading_align_mobile

  assign slider_view = section.settings.slider_view
  assign slider_view_mobile = section.settings.slider_view_mobile
  assign slider_gap = section.settings.slider_gap
  assign slider_gap_mobile = section.settings.slider_gap_mobile
  assign slider_mt = section.settings.slider_mt
  assign slider_mt_mobile = section.settings.slider_mt_mobile

  assign slide_border_thickness = section.settings.slide_border_thickness
  assign slide_border_color = section.settings.slide_border_color
  assign slide_radius = section.settings.slide_radius

  assign slide_radius_divided = slide_radius | divided_by: 20
  assign slide_radius_image = slide_radius | minus: slide_radius_divided

  assign arrow_size = section.settings.arrow_size
  assign arrow_size_mobile = section.settings.arrow_size_mobile
  assign arrow_icon_size = section.settings.arrow_icon_size
  assign arrow_icon_size_mobile = section.settings.arrow_icon_size_mobile
  assign arrow_color = section.settings.arrow_color
  assign arrow_hover_color = section.settings.arrow_hover_color
  assign arrow_bg_color = section.settings.arrow_bg_color
  assign arrow_bg_hover_color = section.settings.arrow_bg_hover_color
  assign arrow_radius = section.settings.arrow_radius
  assign arrow_border_thickness = section.settings.arrow_border_thickness
  assign arrow_border_color = section.settings.arrow_border_color
  assign arrow_border_hover_color = section.settings.arrow_border_hover_color
  assign arrow_show_desktop = section.settings.arrow_show_desktop
  assign arrow_show_mobile = section.settings.arrow_show_mobile
  assign arrow_hover_effect = section.settings.arrow_hover_effect

  assign modal_overlay = section.settings.modal_overlay
  assign modal_overlay_color = section.settings.modal_overlay_color

  assign modal_buttons_size = section.settings.modal_buttons_size
  assign modal_buttons_size_mobile = section.settings.modal_buttons_size_mobile
  assign modal_buttons_icon_color = section.settings.modal_buttons_icon_color

  assign modal_slider_view = section.settings.modal_slider_view
  assign modal_slider_gap = section.settings.modal_slider_gap

  assign modal_autoplay = section.settings.modal_autoplay
  assign modal_autoplay_delay = section.settings.modal_autoplay_delay

  assign modal_image_radius = section.settings.modal_image_radius
  assign modal_image_border_thickness = section.settings.modal_image_border_thickness
  assign modal_image_border_color = section.settings.modal_image_border_color
  assign modal_image_ratio = section.settings.modal_image_ratio
  assign modal_image_ratio_mobile = section.settings.modal_image_ratio_mobile

  assign modal_arrow_show_desktop = section.settings.modal_arrow_show_desktop
  assign modal_arrow_show_mobile = section.settings.modal_arrow_show_mobile

  assign modal_circle_size = section.settings.modal_circle_size
  assign modal_circle_size_mobile = section.settings.modal_circle_size_mobile
  assign modal_circle_border_thickness = section.settings.modal_circle_border_thickness
  assign modal_circle_border_color = section.settings.modal_circle_border_color

  assign author_size = section.settings.author_size
  assign author_size_mobile = section.settings.author_size_mobile
  assign author_color = section.settings.author_color
  assign author_custom = section.settings.author_custom
  assign author_font = section.settings.author_font
  assign author_height = section.settings.author_height

  assign text_size = section.settings.text_size
  assign text_size_mobile = section.settings.text_size_mobile
  assign text_color = section.settings.text_color
  assign text_custom = section.settings.text_custom
  assign text_font = section.settings.text_font
  assign text_height = section.settings.text_height

  assign toggle_text = section.settings.toggle_text
  assign toggle_hide_text = section.settings.toggle_hide_text
  assign toggle_size = section.settings.toggle_size
  assign toggle_size_mobile = section.settings.toggle_size_mobile
  assign toggle_color = section.settings.toggle_color
  assign toggle_custom = section.settings.toggle_custom
  assign toggle_font = section.settings.toggle_font
  assign toggle_height = section.settings.toggle_height
  assign toggle_mt = section.settings.toggle_mt
  assign toggle_mt_mobile = section.settings.toggle_mt_mobile

  assign products_modal_bg_color = section.settings.products_modal_bg_color
  assign products_modal_overlay_color = section.settings.products_modal_overlay_color

  assign product_cards_align = section.settings.product_cards_align
  assign product_cards_gap_mobile = section.settings.product_cards_gap_mobile
  assign product_cards_gap = section.settings.product_cards_gap

  assign product_card_width_mobile = section.settings.product_card_width_mobile
  assign product_card_width = section.settings.product_card_width
  assign product_card_border_thickness = section.settings.product_card_border_thickness
  assign product_card_border_color = section.settings.product_card_border_color
  assign product_card_bg_color = section.settings.product_card_bg_color
  assign product_card_radius = section.settings.product_card_radius

  assign product_image_ratio = section.settings.product_image_ratio
  assign product_image_ratio_mobile = section.settings.product_image_ratio_mobile

  assign title_size = section.settings.title_size
  assign title_size_mobile = section.settings.title_size_mobile
  assign title_color = section.settings.title_color
  assign title_hover_color = section.settings.title_hover_color
  assign title_custom = section.settings.title_custom
  assign title_font = section.settings.title_font
  assign title_height = section.settings.title_height
  assign title_mt = section.settings.title_mt
  assign title_mt_mobile = section.settings.title_mt_mobile

  assign details_size = section.settings.details_size
  assign details_size_mobile = section.settings.details_size_mobile
  assign details_color = section.settings.details_color
  assign details_custom = section.settings.details_custom
  assign details_font = section.settings.details_font
  assign details_height = section.settings.details_height
  assign details_mt = section.settings.details_mt
  assign details_mt_mobile = section.settings.details_mt_mobile
  
-%}

{%- style -%}

  {{ heading_font | font_face: font_display: 'swap' }}
  {{ author_font | font_face: font_display: 'swap' }}
  {{ text_font | font_face: font_display: 'swap' }}
  {{ toggle_font | font_face: font_display: 'swap' }}
  {{ title_font | font_face: font_display: 'swap' }}
  {{ details_font | font_face: font_display: 'swap' }}
  
  .section-{{ section.id }} {
    border-top: solid {{ border_color }} {{ border_thickness }}px;
    border-bottom: solid {{ border_color }} {{ border_thickness }}px;
    margin-top: {{ margin_top | times: 0.75 | round: 0 }}px;
    margin-bottom: {{ margin_bottom | times: 0.75 | round: 0 }}px;
    margin-left: {{ margin_horizontal_mobile }}rem;
    margin-right: {{ margin_horizontal_mobile }}rem;
    border-radius: {{ section_radius | times: 0.6 | round: 0 }}px;
    overflow: hidden;
  }
  
  .section-{{ section.id }}-settings {
    margin: 0 auto;
    padding-top: {{ padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ padding_bottom | times: 0.75 | round: 0 }}px;
    padding-left: {{ padding_horizontal_mobile }}rem;
    padding-right: {{ padding_horizontal_mobile }}rem;
  }

  .instafeed-heading-{{ section.id }} {
    text-align: {{ heading_align_mobile }};
  }

  .instafeed-heading-{{ section.id }} * {
    margin: 0;
    font-size: {{ heading_size_mobile }}px;
    color: {{ heading_color }};
    line-height: {{ heading_height }}%;
    text-transform: unset;
  }

  .instafeed-slider-wrapper-{{ section.id }} {
    margin-top: {{ slider_mt_mobile }}px;
    position: relative;
  }

  .instafeed-slider-{{ section.id }} {
    margin-left: -{{ padding_horizontal_mobile }}px !important;
    margin-right: -{{ padding_horizontal_mobile }}px !important;
    padding-left: {{ padding_horizontal_mobile }}px !important;
    padding-right: {{ padding_horizontal_mobile }}px !important;
    overflow: visible !important;
  }

  .instafeed-slider-{{ section.id }} .swiper-wrapper {
    align-items: stretch !important;
  }

  .instafeed-slide-{{ section.id }} {
    overflow: hidden;
    border: {{ slide_border_thickness }}px solid {{ slide_border_color }};
    cursor: pointer;
    box-sizing: border-box !important;
    aspect-ratio: 1;
    border-radius: {{ slide_radius }}px;
  }

  .instafeed-slide-{{ section.id }} img,
  .instafeed-slide-{{ section.id }} svg {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
    box-shadow: none;
    border: 0px;
    border-radius: {{ slide_radius_image }}px;
    position: absolute;
  }

  .instafeed-slide-{{ section.id }} svg {
    background-color: #AFAFAF;
  }

  .instafeed-btn-prev-{{ section.id }},
  .instafeed-btn-next-{{ section.id }} {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 2;
    width: {{ arrow_size_mobile }}px;
    height: {{ arrow_size_mobile }}px;
    border: 0px;
    border: {{ arrow_border_thickness }}px solid {{ arrow_border_color }};
    border-radius: {{ arrow_radius }}px;
    background: transparent;
    background: {{ arrow_bg_color }};
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease 0s;
    cursor: pointer;
    -webkit-appearance: none;
  }

  .instafeed-btn-prev-{{ section.id }} {
    left: 0px;
  }

  .instafeed-btn-next-{{ section.id }} {
    right: 0px;
  }

  .instafeed-btn-prev-{{ section.id }} .animate-icon,
  .instafeed-btn-next-{{ section.id }} .animate-icon {
    pointer-events: none;
    place-items: center;
    display: grid;
  }

  .instafeed-btn-prev-{{ section.id }} .animate-icon:before,
  .instafeed-btn-next-{{ section.id }} .animate-icon:before {
    content: "";
    grid-area: 1 / -1;
    transition: all .2s ease;
    width: {{ arrow_icon_size_mobile }}px;
    height: {{ arrow_icon_size_mobile }}px;
    transform: rotate(calc(1 * 45deg));
    box-sizing: border-box;
    border-style: solid;
    border: 0px;
    border-right: 2px solid currentColor;
    border-top: 2px solid currentColor;
    position: relative;
    left: -1px;
  }

  .instafeed-btn-prev-{{ section.id }} .animate-icon:before {
    left: unset;
    right: -1px;
    border-right: 0px;
    border-top: 0px;
    border-bottom: 2px solid currentColor;
    border-left: 2px solid currentColor;
  }

  .instafeed-btn-prev-{{ section.id }} .animate-icon:after,
  .instafeed-btn-next-{{ section.id }} .animate-icon:after {
    content: "";
    grid-area: 1 / -1;
    transition: all .2s ease;
    width: {{ arrow_icon_size_mobile | minus: 0.3 }}px;
    height: 1.6px;
    transform-origin: center;
    opacity: 0;
    background: currentColor;
    transform: scaleX(.5);
  }

  .instafeed-btn-prev-{{ section.id }} span,
  .instafeed-btn-next-{{ section.id }} span {
    color: {{ arrow_color }};
  }

  .instafeed-btn-prev-{{ section.id }}.swiper-button-disabled,
  .instafeed-btn-next-{{ section.id }}.swiper-button-disabled {
    opacity: 0.5;
  }

  .instafeed-modal-{{ section.id }} {
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: {{ modal_overlay_color | hex_to_rgba: modal_overlay }};
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    padding-top: {{ modal_buttons_size_mobile | plus: 20 }}px;
    opacity: 0;
    pointer-events: none;
    z-index: -1;
    transition: all 0.25s ease 0s;
    overflow: hidden;
  }

  .instafeed-modal-{{ section.id }}.active {
    opacity: 1;
    pointer-events: all;
    z-index: 100;
    transition: all 0.25s ease 0s;
  }

  .instafeed-modal-inner-{{ section.id }} {
    width: 100%;
    display: grid;
    max-height: 80vh;
    height: 100%;
    position: relative;
    z-index: 1;
    overflow: hidden;
  }

  .instafeed-modal-slider-{{ section.id }} {
    margin-left: -20px !important;
    margin-right: -20px !important;
    padding-left: 20px !important;
    padding-right: 20px !important;
    max-height: 80vh !important;
  }

  .instafeed-modal-close-{{ section.id }},
  .instafeed-modal-btn-prev-{{ section.id }},
  .instafeed-modal-btn-next-{{ section.id }} {
    width: {{ modal_buttons_size_mobile }}px;
    height: {{ modal_buttons_size_mobile }}px;
    border-radius: 50%;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: {{ modal_buttons_size_mobile | times: 0.25 }}px;
    background-color: transparent;
    border: 0px;
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
    background: rgba(0, 0, 0, .2);
    cursor: pointer;
  }

  .instafeed-modal-close-{{ section.id }} svg,
  .instafeed-modal-btn-prev-{{ section.id }} svg,
  .instafeed-modal-btn-next-{{ section.id }} svg {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .instafeed-modal-close-{{ section.id }} svg path,
  .instafeed-modal-btn-prev-{{ section.id }} svg path,
  .instafeed-modal-btn-next-{{ section.id }} svg path {
    fill: {{ modal_buttons_icon_color }};
  }

  .instafeed-modal-close-{{ section.id }} {
    position: fixed;
    top: 10px;
    right: 10px;
    z-index: 2;
  }

  .instafeed-modal-btn-prev-{{ section.id }},
  .instafeed-modal-btn-next-{{ section.id }} {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 2;
  }

  .instafeed-modal-btn-prev-{{ section.id }} {
    left: 20px;
  }

  .instafeed-modal-btn-next-{{ section.id }} {
    right: 20px;
  }

  .instafeed-modal-btn-prev-{{ section.id }} svg {
    transform: rotate(-180deg);
  }

  .instafeed-modal-slide-{{ section.id }} {
    position: relative;
    box-sizing: border-box !important;
    -webkit-filter: blur(6px);
    filter: blur(6px);
    -webkit-transform: scale(.85)!important;
    transform: scale(.85)!important;
    transition: -webkit-transform .2s;
    transition: transform .2s;
    transition: transform .2s,-webkit-transform .2s;
      
  }

  .instafeed-modal-slide-{{ section.id }}.swiper-slide-active {
    -webkit-filter: blur(0);
    filter: blur(0);
    -webkit-transform: scale(1)!important;
    transform: scale(1)!important;
  }

  .instafeed-modal-image-{{ section.id }} {
    position: relative;
    border: {{ modal_image_border_thickness }}px solid {{ modal_image_border_color }};
    border-radius: {{ modal_image_radius }}px;
    overflow: hidden;
    max-height: 80%;
    width: 100%;
  }

  .instafeed-modal-image-{{ section.id }} img,
  .instafeed-modal-image-{{ section.id }} svg {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .instafeed-modal-image-{{ section.id }} svg {
    background-color: #AFAFAF;
  }

  #progress{{ section.id | replate: '-', '' }} {
    width: 100%;
    height: 2px;
    background-color: rgba(255, 255, 255, 0.2);
  }

  #progress{{ section.id | replate: '-', '' }}[value] {
    appearance: none;
    border: none;
    color: #ffffff;
  }

  #progress{{ section.id | replate: '-', '' }}[value]::-webkit-progress-value {
    background: white;
    transition: width 0.5s linear;
  }
  
  #progress{{ section.id | replate: '-', '' }}[value]::-moz-progress-bar {
    background: #ede8e8:
  }

  .instafeed-modal-slide-top-{{ section.id }} {
    position: absolute;
    left: 0px;
    top: 0px;
    z-index: 2;
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding: 16px 8px;
    background: linear-gradient(180deg, #212121, rgba(33, 33, 33, 0));
  }

  .instafeed-modal-slide-row-{{ section.id }} {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .instafeed-modal-slide-circle-{{ section.id }} {
    flex: 0 0 {{ modal_circle_size_mobile }}px;
    height: {{ modal_circle_size_mobile }}px;
    border-radius: 50%;
    overflow: hidden;
    border: {{ modal_circle_border_thickness }}px solid {{ modal_circle_border_color }};
  }

  .instafeed-modal-slide-circle-{{ section.id }} img,
  .instafeed-modal-slide-circle-{{ section.id }} svg {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .instafeed-modal-slide-circle-{{ section.id }} svg {
    background-color: #AFAFAF;
  }

  .instafeed-modal-slide-author-{{ section.id }} {
    margin: 0px;
    font-size: {{ author_size_mobile }}px;
    color: {{ author_color }};
    line-height: {{ author_height }}%;
    text-transform: unset;
  }

  .instafeed-modal-slide-text-{{ section.id }} {
    position: absolute;
    left: 0;
    bottom: 0;
    width: 100%;
    z-index: 2;
    padding: 24px 16px;
    background: linear-gradient(0deg, #212121, rgba(33, 33, 33, 0));
    margin: 0px;
    font-size: {{ text_size_mobile }}px;
    color: {{ text_color }};
    line-height: {{ text_height }}%;
    text-transform: unset;
    font-weight: 700;
  }

  .instafeed-modal-slide-toggle-{{ section.id }} {
    opacity: 0;
    transition: all 0.25s ease 0s;
    margin: 0px;
    margin-top: {{ toggle_mt_mobile }}px;
    font-size: {{ toggle_size_mobile }}px;
    color: {{ toggle_color }};
    line-height: {{ toggle_height }}%;
    text-transform: unset;
    text-align: center;
    cursor: pointer;
  }

  .instafeed-modal-slide-{{ section.id }}.swiper-slide-active .instafeed-modal-slide-toggle-{{ section.id }},
  .instafeed-modal-slide-toggle-{{ section.id }}.instafeed-modal-slide-hide-toggle-{{ section.id }}{
    opacity: 1;
    transition: all 0.25s ease 0s;
  }

  .instafeed-products-modal-{{ section.id }} {
    position: fixed;
    top: 0;
    bottom: 0;
    right: 0;
    left: 0;
    height: 100%;
    background: {{ products_modal_overlay_color | hex_to_rgba: 0.7 }};
    z-index: 999999999;
    display: none;
    align-items: flex-end;
  }

  .instafeed-products-modal-{{ section.id }}.active {
    display: flex;
  }

  .instafeed-products-modal-inner-{{ section.id }} {
    min-height: 35%;
    width: 100%;
    background: {{ products_modal_bg_color }};
    padding-bottom: 30px;
  }

  .instafeed-products-modal-grid-{{ section.id }} {
    transform: translateY(-30%);
    overflow-x: auto;
    display: flex;
    align-items: stretch;
    gap: {{ product_cards_gap_mobile }}px;
    scrollbar-width: 0px;
    max-width: fit-content;
    padding: 0px 30px;
  }

  .instafeed-products-modal-grid-{{ section.id }}::-webkit-scrollbar {
    width: 0px;
    display: none;
  }

  .instafeed-product-card-{{ section.id }} {
    width: {{ product_card_width_mobile }}px;
    border: {{ product_card_border_thickness }}px solid {{ product_card_border_color }};
    background-color: {{ product_card_bg_color }};
    padding: 20px;
    border-radius: {{ product_card_radius }}px;
    overflow: hidden;
    flex-shrink: 0;
  }

  .instafeed-product-image-{{ section.id }} {
    overflow: hidden;
    display: block;
  }

  .instafeed-product-image-{{ section.id }} img,
  .instafeed-product-image-{{ section.id }} svg {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .instafeed-product-image-{{ section.id }} svg {
    background-color: #AFAFAF;
  }

  .instafeed-product-title-{{ section.id }} {
    display: block;
    max-width: fit-content;
    margin: 0px;
    margin-top: {{ title_mt_mobile }}px;
    font-size: {{ title_size_mobile }}px;
    color: {{ title_color }};
    line-height: {{ title_height }}%;
    text-transform: unset;
    text-decoration: none;
    transition: all 0.25s ease 0s;
  }

  .instafeed-product-title-{{ section.id }}:hover {
    color: {{ title_hover_color }};
    transition: all 0.25s ease 0s;
  }

  .instafeed-product-details-{{ section.id }} {
    margin: 0px;
    margin-top: {{ details_mt_mobile }}px;
    font-size: {{ details_size_mobile }}px;
    color: {{ details_color }};
    line-height: {{ details_height }}%;
    text-transform: unset;
  }
  
  @media(min-width: 1024px) {

    .section-{{ section.id }} {
      margin-top: {{ margin_top }}px;
      margin-bottom: {{ margin_bottom }}px;
      margin-left: {{ margin_horizontal }}rem;
      margin-right: {{ margin_horizontal }}rem;
      border-radius: {{ section_radius }}px;
    }
    
    .section-{{ section.id }}-settings {
      padding: 0 5rem;
      padding-top: {{ padding_top }}px;
      padding-bottom: {{ padding_bottom }}px;
      padding-left: {{ padding_horizontal }}rem;
      padding-right: {{ padding_horizontal }}rem;
    }

    .instafeed-heading-{{ section.id }} {
      text-align: {{ heading_align }};
    }
  
    .instafeed-heading-{{ section.id }} * {
      font-size: {{ heading_size }}px;
    }

    .instafeed-slider-{{ section.id }} {
      margin-left: 0px !important;
      margin-right: 0px !important;
      padding-left: 0px !important;
      padding-right: 0px !important;
      overflow: hidden !important;
    }
    
    .instafeed-slider-wrapper-{{ section.id }} {
      margin-top: {{ slider_mt }}px;
      padding-left: {{ arrow_size | plus: 10 }}px;
      padding-right: {{ arrow_size | plus: 10 }}px;
    }

    .instafeed-btn-prev-{{ section.id }},
    .instafeed-btn-next-{{ section.id }} {
      width: {{ arrow_size }}px;
      height: {{ arrow_size }}px;
      transition: all 0.25s ease 0s;
    }
    
    .instafeed-btn-prev-{{ section.id }} .animate-icon:before,
    .instafeed-btn-next-{{ section.id }} .animate-icon:before {
      width: {{ arrow_icon_size }}px;
      height: {{ arrow_icon_size }}px;
    }

    .instafeed-btn-prev-{{ section.id }} .animate-icon:after,
    .instafeed-btn-next-{{ section.id }} .animate-icon:after {
      width: {{ arrow_icon_size | minus: 0.3 }}px;
    }

    .instafeed-modal-{{ section.id }} {
      padding-top: {{ modal_buttons_size | plus: 20 }}px;
    }

    .instafeed-modal-close-{{ section.id }} {
      top: 20px;
      right: 20px;
    }

    .instafeed-modal-close-{{ section.id }},
    .instafeed-modal-btn-prev-{{ section.id }},
    .instafeed-modal-btn-next-{{ section.id }} {
      width: {{ modal_buttons_size }}px;
      height: {{ modal_buttons_size }}px;
      padding: {{ modal_buttons_size | times: 0.25 }}px;
    }

    .instafeed-modal-slide-circle-{{ section.id }} {
      flex: 0 0 {{ modal_circle_size }}px;
      height: {{ modal_circle_size }}px;
    }

    .instafeed-modal-slide-author-{{ section.id }} {
      font-size: {{ author_size }}px;
    }

    .instafeed-modal-slide-text-{{ section.id }} {
      font-size: {{ text_size }}px;
    }

    .instafeed-modal-slide-toggle-{{ section.id }} {
      margin-top: {{ toggle_mt }}px;
      font-size: {{ toggle_size }}px;
    }

    .instafeed-product-card-{{ section.id }} {
      width: {{ product_card_width }}px;
    }

    .instafeed-product-title-{{ section.id }} {
      margin-top: {{ title_mt }}px;
      font-size: {{ title_size }}px;
    }

    .instafeed-product-details-{{ section.id }} {
      margin-top: {{ details_mt }}px;
      font-size: {{ details_size }}px;
    }

    .instafeed-products-modal-grid-{{ section.id }} {
      gap: {{ product_cards_gap }}px;
    }
  }
  
{%- endstyle -%}

{% unless full_width %}
  <style>
    .section-{{ section.id }}-settings {
      max-width: {{ content_width }}px;
    }
  </style>
{% endunless %}

{% if margin_horizontal_mobile > 0 %}
  <style>
    .section-{{ section.id }} {
      border-left: solid {{ border_color }} {{ border_thickness }}px;
      border-right: solid {{ border_color }} {{ border_thickness }}px;
    }
    
    @media(min-width: 1024px) {
      .section-{{ section.id }} {
        border-left: 0px;
        border-right: 0px;
      }
    }
  </style>
{% endif %}

{% if slide_border_thickness > 0 %}
  <style>
    .instafeed-slide-{{ section.id }} {
      padding: 2px;
    }

    .instafeed-slide-{{ section.id }} img,
    .instafeed-slide-{{ section.id }} svg {
      width: calc(100% - 4px);
      height: calc(100% - 4px);
      left: 2px;
      top: 2px;
    }
  </style>
{% else %}
  <style>
  .instafeed-slide-{{ section.id }} img,
    .instafeed-slide-{{ section.id }} svg {
      width: 100%;
      height: 100%;
      left: 0px;
      top: 0px;
    }
  </style>
{% endif %}

{% if margin_horizontal > 0 %}
  <style>
    @media(min-width: 1024px) {
      .section-{{ section.id }} {
        border-left: solid {{ border_color }} {{ border_thickness }}px;
        border-right: solid {{ border_color }} {{ border_thickness }}px;
      }
    }
  </style>
{% endif %}

{% if heading_custom %}
  <style>
    .instafeed-heading-{{ section.id }} * {
      font-family: {{ heading_font.family }}, {{ heading_font.fallback_families }};
      font-weight: {{ heading_font.weight }};
      font-style: {{ heading_font.style }};
    }
  </style>
{% endif %}

{% if author_custom %}
  <style>
    .instafeed-modal-slide-author-{{ section.id }} {
      font-family: {{ author_font.family }}, {{ author_font.fallback_families }};
      font-weight: {{ author_font.weight }};
      font-style: {{ author_font.style }};
    }
  </style>
{% endif %}

{% if text_custom %}
  <style>
    .instafeed-modal-slide-text-{{ section.id }} {
      font-family: {{ text_font.family }}, {{ text_font.fallback_families }};
      font-weight: {{ text_font.weight }};
      font-style: {{ text_font.style }};
    }
  </style>
{% endif %}

{% if toggle_custom %}
  <style>
    .instafeed-modal-slide-toggle-{{ section.id }} {
      font-family: {{ toggle_font.family }}, {{ toggle_font.fallback_families }};
      font-weight: {{ toggle_font.weight }};
      font-style: {{ toggle_font.style }};
    }
  </style>
{% endif %}

{% if title_custom %}
  <style>
    .instafeed-product-title-{{ section.id }} {
      font-family: {{ title_font.family }}, {{ title_font.fallback_families }};
      font-weight: {{ title_font.weight }};
      font-style: {{ title_font.style }};
    }
  </style>
{% endif %}

{% if details_custom %}
  <style>
    .instafeed-product-details-{{ section.id }} {
      font-family: {{ details_font.family }}, {{ details_font.fallback_families }};
      font-weight: {{ details_font.weight }};
      font-style: {{ details_font.style }};
    }
  </style>
{% endif %}

{% if arrow_hover_effect == "color" %}
  <style>
    .instafeed-btn-prev-{{ section.id }}:hover,
    .instafeed-btn-next-{{ section.id }}:hover {
      transition: all 0.3s ease 0s;
      border: {{ arrow_border_thickness }}px solid {{ arrow_border_hover_color }};
      background: {{ arrow_bg_hover_color }};
    }
  
    .instafeed-btn-prev-{{ section.id }}:hover .animate-icon,
    .instafeed-btn-next-{{ section.id }}:hover .animate-icon {
      color: {{ arrow_hover_color }};
    }
  </style>
{% elsif arrow_hover_effect == "scale" %}
  <style>
    .instafeed-btn-prev-{{ section.id }}:hover,
    .instafeed-btn-next-{{ section.id }}:hover {
      transform: scale(0.9) translateY(-50%);
    }

    @media(min-width: 1024px) {
      .instafeed-btn-prev-{{ section.id }}:hover,
      .instafeed-btn-next-{{ section.id }}:hover {
        transform: scale(0.9) translateY(-50%);
      }
    }
  </style>
{% elsif arrow_hover_effect == "arrow" %}
  <style>
    .instafeed-btn-next-{{ section.id }}:hover .animate-icon:before {
      transform: translate(calc(1 * 0.125rem)) rotate(calc(1 * 45deg));
    }
  
    .instafeed-btn-prev-{{ section.id }}:hover .animate-icon:before {
      transform: translate(calc(-1 * 0.125rem)) rotate(calc(1 * 45deg));
    }
    
    .instafeed-btn-prev-{{ section.id }}:hover .animate-icon:after,
    .instafeed-btn-next-{{ section.id }}:hover .animate-icon:after {
      opacity: 1;
      transform: scaleX(1);
    }
  </style>
{% endif %}

{% if arrow_show_mobile %}
  <style>
    .instafeed-btn-prev-{{ section.id }},
    .instafeed-btn-next-{{ section.id }} {
      display: flex;
    }

    .instafeed-slider-wrapper-{{ section.id }} {
      padding-left: {{ arrow_size_mobile | plus: 10 }}px;
      padding-right: {{ arrow_size_mobile | plus: 10 }}px;
    }
  </style>
{% else %}
  <style>
    .instafeed-btn-prev-{{ section.id }},
    .instafeed-btn-next-{{ section.id }} {
      display: none;
    }
  </style>
{% endif %}

{% if arrow_show_desktop %}
  <style>
    @media(min-width: 1024px) {
      .instafeed-btn-prev-{{ section.id }},
      .instafeed-btn-next-{{ section.id }} {
        display: flex;
      }

      .instafeed-slider-wrapper-{{ section.id }} {
        padding-left: {{ arrow_size | plus: 10 }}px;
        padding-right: {{ arrow_size | plus: 10 }}px;
      }
    }
  </style>
{% else %}
  <style>
    @media(min-width: 1024px) {
      .instafeed-btn-prev-{{ section.id }},
      .instafeed-btn-next-{{ section.id }} {
        display: none;
      }

      .instafeed-slider-wrapper-{{ section.id }} {
        padding-left: 0px;
        padding-right: 0px;
      }
    }
  </style>
{% endif %}

{% if modal_image_ratio_mobile == "portrait" %}
  <style>
    .instafeed-modal-image-{{ section.id }} {
      aspect-ratio: 9.6/13;
    }
  </style>
{% elsif modal_image_ratio_mobile == "landscape" %}
  <style>
  .instafeed-modal-image-{{ section.id }} {
    aspect-ratio: 12/8;
  }
  </style>
{% elsif modal_image_ratio_mobile == "square" %}
  <style>
    .instafeed-modal-image-{{ section.id }} {
      aspect-ratio: 12/12;
    }
  </style>
{% else %}
  <style>
    .instafeed-modal-image-{{ section.id }} {
      aspect-ratio: auto;
    }
  </style>
{% endif %}

{% if modal_image_ratio == "portrait" %}
  <style>
    @media(min-width: 1024px) {
      .instafeed-modal-image-{{ section.id }} {
        aspect-ratio: 9.6/13;
      }
    }
    
  </style>
{% elsif modal_image_ratio == "landscape" %}
  <style>
    @media(min-width: 1024px) {
      .instafeed-modal-image-{{ section.id }} {
        aspect-ratio: 12/8;
      }
    }  
  </style>
{% elsif modal_image_ratio == "square" %}
  <style>
    @media(min-width: 1024px) {
      .instafeed-modal-image-{{ section.id }} {
        aspect-ratio: 12/12;
      }
    }    
  </style>
{% else %}
  <style>
     @media(min-width: 1024px) {
      .instafeed-modal-image-{{ section.id }} {
        aspect-ratio: auto;
      }
    }
  </style>
{% endif %}

{% if product_image_ratio_mobile == "portrait" %}
  <style>
    .instafeed-product-image-{{ section.id }} {
      aspect-ratio: 9.6/13;
    }
  </style>
{% elsif product_image_ratio_mobile == "landscape" %}
  <style>
  .instafeed-product-image-{{ section.id }} {
    aspect-ratio: 12/8;
  }
  </style>
{% elsif product_image_ratio_mobile == "square" %}
  <style>
    .instafeed-product-image-{{ section.id }} {
      aspect-ratio: 12/12;
    }
  </style>
{% else %}
  <style>
    .instafeed-product-image-{{ section.id }} {
      aspect-ratio: auto;
    }
  </style>
{% endif %}

{% if product_image_ratio == "portrait" %}
  <style>
    @media(min-width: 1024px) {
      .instafeed-product-image-{{ section.id }} {
        aspect-ratio: 9.6/13;
      }
    }
    
  </style>
{% elsif product_image_ratio == "landscape" %}
  <style>
    @media(min-width: 1024px) {
      .instafeed-product-image-{{ section.id }} {
        aspect-ratio: 12/8;
      }
    }  
  </style>
{% elsif product_image_ratio == "square" %}
  <style>
    @media(min-width: 1024px) {
      .instafeed-product-image-{{ section.id }} {
        aspect-ratio: 12/12;
      }
    }    
  </style>
{% else %}
  <style>
     @media(min-width: 1024px) {
      .instafeed-product-image-{{ section.id }} {
        aspect-ratio: auto;
      }
    }
  </style>
{% endif %}

{% if modal_arrow_show_mobile %}
  <style>
    .instafeed-modal-btn-prev-{{ section.id }},
    .instafeed-modal-btn-next-{{ section.id }} {
      display: flex;
    }
  </style>
{% else %}
  <style>
    .instafeed-modal-btn-prev-{{ section.id }},
    .instafeed-modal-btn-next-{{ section.id }} {
      display: none;
    }
  </style>
{% endif %}

{% if modal_arrow_show_desktop %}
  <style>
    @media(min-width: 1024px) {
      .instafeed-modal-btn-prev-{{ section.id }},
      .instafeed-modal-btn-next-{{ section.id }} {
        display: flex;
      }
    }
  </style>
{% else %}
  <style>
    @media(min-width: 1024px) {
      .instafeed-modal-btn-prev-{{ section.id }},
      .instafeed-modal-btn-next-{{ section.id }} {
        display: none;
      }
    }
  </style>
{% endif %}

{% if product_cards_align == "center" %}
  <style>
    .instafeed-products-modal-grid-{{ section.id }} {
      margin-left: auto;
      margin-right: auto;
    }
  </style>
{% elsif product_cards_align == "right" %}
  <style>
    .instafeed-products-modal-grid-{{ section.id }} {
      margin-left: auto;
    }
  </style>
{% endif %}

{% comment %} PREVIEW {% endcomment %}
<style>
  .instafeed-slider-{{ section.id }}.preview .swiper-wrapper {
    display: flex;
    align-items: center;
    justify-content: space-between;
    overflow: hidden;
  }

  .instafeed-slider-{{ section.id }}.preview .instafeed-slide-{{ section.id }} {
    width: 100%;
  }

  .instafeed-slider-{{ section.id }}.preview .instafeed-slide-{{ section.id }}:not(:first-child) {
    margin-left: {{ slider_gap_mobile }}px;
  } 

  @media(min-width: 1024px) {
    .instafeed-slider-{{ section.id }}.preview .instafeed-slide-{{ section.id }}:not(:first-child) {
      margin-left: {{ slider_gap }}px;
    } 

    .instafeed-slider-{{ section.id }}.preview .instafeed-slide-{{ section.id }} {
      width: calc(100% / {{ slider_view }} - ({{ slider_gap }}px * {{ slider_view | minus: 1 }}));
    }
  }
</style>

<div class="section-{{ section.id }} instafeed-{{ section.id }}" style="background-color:{{ background_color }}; background-image: {{ background_gradient }};">
    <div class="section-{{ section.id }}-settings">
      {% if heading != blank %}
        <div class="instafeed-heading-{{ section.id }}">{{ heading }}</div>
      {% endif %}

      <div class="instafeed-slider-wrapper-{{ section.id }}">
        <div class="instafeed-slider-{{ section.id }} swiper preview"
          data-slider-view-mobile="{{ slider_view_mobile }}"
          data-slider-gap-mobile="{{ slider_gap_mobile }}"
          data-slider-gap="{{ slider_gap }}"
          data-slider-view="{{ slider_view }}"
          data-slider-view-tablet="{{ slider_view | times: 0.5 | round: 0 }}">
          <div class="swiper-wrapper">
            {% for block in section.blocks %}
              <div class="instafeed-slide-{{ section.id }} swiper-slide">
                {% if block.settings.circle_image != blank %}
                  <img src="{{ block.settings.circle_image | image_url }}" alt="{{ block.settings.circle_image }}" {% if lazy %}loading="lazy"{% endif %}>
                {% elsif block.settings.image != blank %}
                  <img src="{{ block.settings.image | image_url }}" alt="{{ block.settings.image }}" {% if lazy %}loading="lazy"{% endif %}>
                {% else %}
                  {{ 'image' | placeholder_svg_tag }}
                {% endif %}
              </div>
            {% endfor %}
          </div>
        </div>
        <button class="instafeed-btn-prev-{{ section.id }}">
          <span class="animate-icon"></span>
        </button>
        <button class="instafeed-btn-next-{{ section.id }}">
          <span class="animate-icon"></span>
        </button> 
      </div>
    </div>
</div>

<div class="instafeed-modal-{{ section.id }}">
  <button class="instafeed-modal-close-{{ section.id }}">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
      <path fill-rule="evenodd" clip-rule="evenodd" d="M12.0002 10.586L4.70718 3.29297L3.29297 4.70718L10.586 12.0002L3.29297 19.2933L4.70718 20.7075L12.0002 13.4145L19.2933 20.7075L20.7075 19.2933L13.4145 12.0002L20.7075 4.70723L19.2933 3.29302L12.0002 10.586Z" fill="white"></path>
    </svg>
  </button>
  <div class="instafeed-modal-inner-{{ section.id }}">
    <button class="instafeed-modal-btn-prev-{{ section.id }}">
      <svg width="24" height="24" viewBox="0 0 44.308 44.308" fill="#fff" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M31.767 20.849 16.727 5.809a0.923 0.923 0 0 0 -1.305 0l-1.305 1.305a0.923 0.923 0 0 0 0 1.305L27.851 22.154l-13.735 13.734a0.923 0.923 0 0 0 0 1.305l1.306 1.305a0.923 0.923 0 0 0 1.305 0l15.04 -15.04a1.846 1.846 0 0 0 0 -2.61Z"></path></svg>
    </button>
    <div class="instafeed-modal-slider-{{ section.id }} swiper"
      data-modal-slider-gap="{{ modal_slider_gap }}"
      data-modal-slider-view="{{ modal_slider_view }}"
      data-modal-slider-view-tablet="{{ modal_slider_view | times: 0.5 | round: 0 }}"
      data-modal-autoplay="{{ modal_autoplay }}"
      data-modal-autoplay-delay="{{ modal_autoplay_delay }}">
      <div class="swiper-wrapper">
        {% for block in section.blocks %}
          <div class="instafeed-modal-slide-{{ section.id }} swiper-slide">
            <div class="instafeed-modal-image-{{ section.id }}">
              {% if block.settings.image != blank %}
                <img src="{{ block.settings.image | image_url }}" alt="{{ block.settings.image }}" {% if lazy %}loading="lazy"{% endif %}>
              {% else %}
                {{ 'image' | placeholder_svg_tag }}
              {% endif %}
  
              <div class="instafeed-modal-slide-top-{{ section.id }}">
                {% if modal_autoplay %}
                  <progress id="progress{{ section.id | replate: '-', '' }}" max="100" value="0" data-first-prog="{{ modal_autoplay_delay | times: 1000 | minus: 1300 }}" data-prog="{{ modal_autoplay_delay | times: 1000 | minus: 500 }}"></progress>
                {% endif %}
                <div class="instafeed-modal-slide-row-{{ section.id }}">
                  <div class="instafeed-modal-slide-circle-{{ section.id }}">
                    {% if block.settings.image != blank %}
                      <img src="{{ block.settings.image | image_url }}" alt="{{ block.settings.image }}" {% if lazy %}loading="lazy"{% endif %}>
                    {% else %}
                      {{ 'image' | placeholder_svg_tag }}
                    {% endif %}
                  </div>
                  {% if block.settings.author != blank %}
                    <p class="instafeed-modal-slide-author-{{ section.id }}">{{ block.settings.author }}</p>
                  {% endif %}
                </div>
              </div>
  
              {% if block.settings.text != blank %}
                <p class="instafeed-modal-slide-text-{{ section.id }}">{{ block.settings.text }}</p>
              {% endif %}

            </div>

            {% if block.settings.products != blank %}
              <p class="instafeed-modal-slide-toggle-{{ section.id }}" id="{{ block.id }}">{{ toggle_text }}</p>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    </div>
    <button class="instafeed-modal-btn-next-{{ section.id }}">
      <svg width="24" height="24" viewBox="0 0 44.308 44.308" fill="#fff" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M31.767 20.849 16.727 5.809a0.923 0.923 0 0 0 -1.305 0l-1.305 1.305a0.923 0.923 0 0 0 0 1.305L27.851 22.154l-13.735 13.734a0.923 0.923 0 0 0 0 1.305l1.306 1.305a0.923 0.923 0 0 0 1.305 0l15.04 -15.04a1.846 1.846 0 0 0 0 -2.61Z"></path></svg>
    </button>
  </div>
</div>

<div class="instafeed-products-modal-{{ section.id }}">
  <div class="instafeed-products-modal-inner-{{ section.id }}">
   {% for block in section.blocks %}
      {% if block.settings.products != blank %}
        <div class="instafeed-products-modal-grid-{{ section.id }}" data-id="{{ block.id }}">
          {% for product in block.settings.products %}
            <div class="instafeed-product-card-{{ section.id }}">
              <a href="{{ product.url }}" class="instafeed-product-image-{{ section.id }}">
                {% if product.featured_image != blank %}
                  <img src="{{ product.featured_image | image_url }}" alt="{{ product.featured_image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                {% else %}
                  {{ 'image' | svg_placeholder_tag }}
                {% endif %}
              </a>
              <a href="{{ product.url }}" class="instafeed-product-title-{{ section.id }}">{{ product.title }}</a>
              {% if product.metafields.custom.specs.value != blank %}
                <div class="instafeed-product-details-{{ section.id }}"><p>{{ product.metafields.custom.specs.value }}</p></div> 
              {% endif %}
            </div>
          {% endfor %}
        </div>
      {% endif %}
            
    {% endfor %}

     <p class="instafeed-modal-slide-toggle-{{ section.id }} instafeed-modal-slide-hide-toggle-{{ section.id }}">{{ toggle_hide_text }}</p>
  </div>
</div>

<script>
  function loadSwiper(callback) {
  if (window.Swiper) {
    callback();
  } else {
    const script = document.createElement('script');
    script.src = "https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js";
    script.onload = callback;
    document.head.appendChild(script);
  }
}

function initInstafeed8(sectionId) {
  const sliderElement = document.querySelector(`.instafeed-slider-${sectionId}`);
  if (!sliderElement) return;
  
  sliderElement.classList.remove('preview');

  const settings = {
    sliderViewMobile: parseFloat(sliderElement.dataset.sliderViewMobile),
    sliderGapMobile: parseInt(sliderElement.dataset.sliderGapMobile),
    sliderGap: parseInt(sliderElement.dataset.sliderGap),
    sliderView: parseInt(sliderElement.dataset.sliderView),
    sliderViewTablet: parseInt(sliderElement.dataset.sliderViewTablet),
  };

  const slider = new Swiper(`.instafeed-slider-${sectionId}`, {
    speed: 300,
    loop: true,
    navigation: {
      nextEl: `.instafeed-btn-next-${sectionId}`,
      prevEl: `.instafeed-btn-prev-${sectionId}`
    },
    breakpoints: {
      320: {
        spaceBetween: settings.sliderGapMobile,
        slidesPerView: settings.sliderViewMobile
      },
      768: {
        spaceBetween: settings.sliderGapMobile,
        slidesPerView: settings.sliderViewTablet
      },
      1024: {
        spaceBetween: settings.sliderGap,
        slidesPerView: settings.sliderView
      }
    }
  });

  const modalSliderElement = document.querySelector(`.instafeed-modal-slider-${sectionId}`);
  if (!modalSliderElement) return;

  const modalSettings = {
    modalSliderGap: parseInt(modalSliderElement.dataset.modalSliderGap),
    modalSliderView: parseInt(modalSliderElement.dataset.modalSliderView),
    modalSliderViewTablet: parseInt(modalSliderElement.dataset.modalSliderViewTablet),
    modalAutoplay: modalSliderElement.dataset.modalAutoplay === 'true',
    modalAutoplayDelay: parseInt(modalSliderElement.dataset.modalAutoplayDelay),
  };

  // Создаем конфигурацию для модального слайдера
  const modalSliderConfig = {
    speed: 300,
    centeredSlides: true,
    mousewheel: {
      invert: false,
    },
    breakpoints: {
      320: {
        spaceBetween: 20,
        slidesPerView: 1
      },
      768: {
        spaceBetween: 20,
        slidesPerView: modalSettings.modalSliderViewTablet
      },
      1024: {
        spaceBetween: modalSettings.modalSliderGap,
        slidesPerView: modalSettings.modalSliderView
      }
    },
    navigation: {
      nextEl: `.instafeed-modal-btn-next-${sectionId}`,
      prevEl: `.instafeed-modal-btn-prev-${sectionId}`
    },
    // Настраиваем автоплей здесь
    autoplay: {
      delay: modalSettings.modalAutoplayDelay * 1000,
      disableOnInteraction: false,
      pauseOnMouseEnter: true,
      waitForTransition: true,
      enabled: false // Изначально выключен
    }
  };

  const modalSlider = new Swiper(modalSliderElement, modalSliderConfig);

  let slides = document.querySelectorAll(`.instafeed-slide-${sectionId}`);
  let modal = document.querySelector(`.instafeed-modal-${sectionId}`);
  let modalClose = document.querySelector(`.instafeed-modal-close-${sectionId}`);
  let modalSlides = document.querySelectorAll(`.instafeed-modal-slide-${sectionId}`);
  let isModalOpening = false;

  function startModalSlider(activeProgress) {
    return new Promise((resolve) => {
      if (!activeProgress) {
        resolve();
        return;
      }

      // Сбрасываем прогресс
      activeProgress.value = 0;

      // Задержка перед стартом
      setTimeout(() => {
        const startTime = Date.now();
        const duration = (modalSettings.modalAutoplayDelay * 1000) - 500;

        function updateProgress() {
          const elapsed = Date.now() - startTime;
          const progress = Math.min((elapsed / duration) * 100, 100);
          activeProgress.value = progress;

          if (progress < 100 && modal.classList.contains('active')) {
            requestAnimationFrame(updateProgress);
          }
        }

        // Запускаем прогресс-бар
        requestAnimationFrame(updateProgress);

        // Включаем автоплей
        modalSlider.autoplay.enabled = true;
        modalSlider.autoplay.start();

        resolve();
      }, 800); // Задержка перед стартом
    });
  }

  if(slides) {
    slides.forEach((el, index) => {
      el.addEventListener('click', async () => {
        if (isModalOpening) return;
        isModalOpening = true;

        // Останавливаем автоплей если он был запущен
        modalSlider.autoplay.stop();
        modalSlider.autoplay.enabled = false;

        modalSlider.slideToLoop(index + 1);
        modalSlider.slideToLoop(index);

        setTimeout(async () => {
          modalSlider.slides.forEach(async (slide) => {
            if(slide.classList.contains('swiper-slide-active')) {
              document.body.style.overflow = 'hidden';
              modal.classList.add('active');

              if (modalSettings.modalAutoplay) {
                // Сбрасываем все прогресс-бары
                modalSlides.forEach(slide => {
                  const prog = slide.querySelector('progress');
                  if(prog) {
                    prog.value = 0;
                  }
                });

                const activeSlide = modalSlider.slides[modalSlider.activeIndex];
                const activeProgress = activeSlide.querySelector('progress');

                await startModalSlider(activeProgress);
                isModalOpening = false;
              }
            }
          });
        }, 200);
      });
    });
  }

  modalSlider.on('slideChange', async function() {
    if (!modal.classList.contains('active')) return;

    modalSlider.autoplay.stop();

    modalSlides.forEach(slide => {
      const prog = slide.querySelector('progress');
      if(prog) {
        prog.value = 0;
      }
    });

    const activeSlide = modalSlider.slides[modalSlider.activeIndex];
    const activeProgress = activeSlide.querySelector('progress');

    // Небольшая задержка перед запуском нового слайда
    setTimeout(() => {
      const startTime = Date.now();
      const duration = (modalSettings.modalAutoplayDelay * 1000) - 500;

      function updateProgress() {
        const elapsed = Date.now() - startTime;
        const progress = Math.min((elapsed / duration) * 100, 100);
        activeProgress.value = progress;

        if (progress < 100 && modal.classList.contains('active')) {
          requestAnimationFrame(updateProgress);
        }
      }

      requestAnimationFrame(updateProgress);
      modalSlider.autoplay.start();
    }, 100);
  });

  function closeModal() {
    document.body.style.overflow = '';
    modal.classList.remove('active');
    modalSlider.autoplay.stop();
    modalSlider.autoplay.enabled = false;
    isModalOpening = false;

    modalSlides.forEach(slide => {
      const prog = slide.querySelector('progress');
      if(prog) {
        prog.value = 0;
      }
    });
  }

  if(modalClose) {
    modalClose.addEventListener('click', closeModal);
  }

  document.addEventListener('click', (e) => {
    if (e.target == modal) {
      closeModal();
    }
  });

  let toggles = document.querySelectorAll(`.instafeed-modal-slide-toggle-${sectionId}`);
  let productsModal = document.querySelector(`.instafeed-products-modal-${sectionId}`);
  let hideToggle = document.querySelector(`.instafeed-modal-slide-hide-toggle-${sectionId}`);

  if(toggles) {
    toggles.forEach(el => {
      el.addEventListener('click', () => {
        if(productsModal) {
          productsModal.classList.add('active');

          let productsGrid = productsModal.querySelectorAll(`.instafeed-products-modal-grid-${sectionId}`);
          if(productsGrid) {
            productsGrid.forEach(element => {
              let dataId = element.getAttribute('data-id');

              if(el.id != dataId) {
                element.style.display = "none";
              }
            });
          }
        }
      });
    });
  }

  document.addEventListener('click', (e) => {
    if (e.target == productsModal) {
      productsModal.classList.remove('active');
      if(productsModal) {
        let productsGrid = productsModal.querySelectorAll(`.instafeed-products-modal-grid-${sectionId}`);
        if(productsGrid) {
          productsGrid.forEach(element => {
            element.style.display = "flex";
          });
        } 
      }
    }
  });

  if(hideToggle) {
    hideToggle.addEventListener('click', (e) => {
      productsModal.classList.remove('active');
      if(productsModal) {
        let productsGrid = productsModal.querySelectorAll(`.instafeed-products-modal-grid-${sectionId}`);
        if(productsGrid) {
          productsGrid.forEach(element => {
            element.style.display = "flex";
          });
        } 
      }
    });
  }
}

function initializeAllInstafeed8Sections() {
  const sections = document.querySelectorAll('[id^="shopify-section-"]');
  sections.forEach(section => {
    if (section.querySelector('.instafeed-{{ section.id }}')) {
      const sectionId = section.id.replace('shopify-section-', '');
      loadSwiper(() => initInstafeed8(sectionId));
    }
  });
}

if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initializeAllInstafeed8Sections);
} else {
  initializeAllInstafeed8Sections();
}

if (Shopify.designMode) {
  document.addEventListener('shopify:section:load', (event) => {
    const sectionId = event.detail.sectionId;
    if (event.target.querySelector('.instafeed-{{ section.id }}')) {
      loadSwiper(() => initInstafeed8(sectionId));
    }
  });
}
</script>

{% schema %}
  {
    "name": "SS - Instafeed #8",
    "settings": [
      {
        "type": "paragraph",
        "content":"Save settings to see section in action"
      },
      {
        "type": "header",
        "content": "Heading settings"
      },
      {
        "type": "richtext",
        "id": "heading",
        "label": "Heading",
        "default": "<h2>Explore our stories</h2>"
      },
      {
        "type": "checkbox",
        "id": "heading_custom",
        "label": "Use custom font",
        "default": false
      },
      {
        "type": "font_picker",
        "id": "heading_font",
        "label": "Font family",
        "default": "josefin_sans_n4"
      },
      {
        "type": "range",
        "id": "heading_size",
        "min": 0,
        "max": 72,
        "step": 2,
        "unit": "px",
        "label": "Font size",
        "default": 28
      },
      {
        "type": "range",
        "id": "heading_size_mobile",
        "min": 0,
        "max": 72,
        "step": 2,
        "unit": "px",
        "label": "Font size - mobile",
        "default": 20
      },
      {
        "type": "range",
        "id": "heading_height",
        "min": 50,
        "max": 200,
        "step": 10,
        "unit": "%",
        "label": "Line height",
        "default": 130
      },
      {
        "type": "text_alignment",
        "id": "heading_align",
        "label": "Alignment",
        "default": "center"
      },
      {
        "type": "text_alignment",
        "id": "heading_align_mobile",
        "label": "Alignment - mobile",
        "default": "center"
      },
      {
        "type": "header",
        "content": "Slider settings"
      },
      {
        "type": "range",
        "id": "slider_view",
        "min": 1,
        "max": 8,
        "step": 1,
        "label": "Slides per view",
        "default": 7
      },
      {
        "type": "range",
        "id": "slider_view_mobile",
        "min": 1,
        "max": 5,
        "step": 0.1,
        "label": "Slides per view - mobile",
        "default": 3.6
      },
      {
        "type": "range",
        "id": "slider_gap",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Gap",
        "default": 16
      },
      {
        "type": "range",
        "id": "slider_gap_mobile",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Gap - mobile",
        "default": 16
      },
      {
        "type": "range",
        "id": "slider_mt",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Margin top",
        "default": 32
      },
      {
        "type": "range",
        "id": "slider_mt_mobile",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Margin top - mobile",
        "default": 28
      },
      {
        "type": "header",
        "content": "Slide settings"
      },
      {
         "type": "range",
         "id": "slide_radius",
         "min": 0,
         "max": 200,
         "step": 4,
         "unit": "px",
         "label": "Roundness",
         "default": 100
      },
      {
         "type": "range",
         "id": "slide_border_thickness",
         "min": 0,
         "max": 10,
         "step": 1,
         "unit": "px",
         "label": "Border thickness",
         "default": 2
      },
      {
        "type": "header",
        "content": "Arrow settings"
      },
      {
        "type": "range",
        "id": "arrow_size",
        "min": 10,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Size",
        "default": 48
      },
      {
        "type": "range",
        "id": "arrow_size_mobile",
        "min": 10,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Size - mobile",
        "default": 38
      },
      {
        "type": "range",
        "id": "arrow_icon_size",
        "min": 5,
        "max": 15,
        "step": 1,
        "unit": "px",
        "label": "Icon size",
        "default": 10
      },
      {
        "type": "range",
        "id": "arrow_icon_size_mobile",
        "min": 5,
        "max": 15,
        "step": 1,
        "unit": "px",
        "label": "Icon size - mobile",
        "default": 8
      },
      {
        "type": "range",
        "id": "arrow_border_thickness",
        "min": 0,
        "max": 10,
        "step": 1,
        "unit": "px",
        "label": "Border thickness",
        "default": 0
      },
      {
        "type": "range",
        "id": "arrow_radius",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Roundness",
        "default": 100
      },
      {
        "type": "select",
        "id": "arrow_hover_effect",
        "label": "Hover effect",
        "default": "color",
        "options": [
          {
            "label": "Change color",
            "value": "color"
          },
          {
            "label": "Change size",
            "value": "scale"
          },
          {
            "label": "Change arrow",
            "value": "arrow"
          },
          {
            "label": "None",
            "value": "none"
          }
        ]
      },
      {
        "type": "checkbox",
        "id": "arrow_show_desktop",
        "label": "Show on desktop",
        "default": false
      },
      {
        "type": "checkbox",
        "id": "arrow_show_mobile",
        "label": "Show on mobile",
        "default": false
      },
      {
        "type": "header",
        "content": "Modal settings"
      },
      {
        "type": "range",
        "id": "modal_overlay",
        "min": 0,
        "max": 1,
        "step": 0.1,
        "label": "Overlay",
        "default": 1
      },
      {
        "type": "header",
        "content": "Modal slider settings"
      },
      {
        "type": "range",
        "id": "modal_slider_view",
        "min": 1,
        "max": 5,
        "step": 1,
        "label": "Slides per view",
        "default": 3
      },
      {
        "type": "range",
        "id": "modal_slider_gap",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Gap",
        "default": 60
      },
      {
        "type": "checkbox",
        "label": "Use autoplay",
        "id": "modal_autoplay",
        "default": true
      },
      {
        "type": "range",
        "id": "modal_autoplay_delay",
        "min": 2,
        "max": 10,
        "step": 1,
        "unit": "s",
        "label": "Autoplay delay",
        "default": 6
      },
      {
        "type": "header",
        "content": "Modal image settings"
      },  
      {
        "type": "range",
        "id": "modal_image_radius",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Roundness",
        "default": 0
      },
      {
        "type": "range",
        "id": "modal_image_border_thickness",
        "min": 0,
        "max": 10,
        "step": 1,
        "unit": "px",
        "label": "Border thickness",
        "default": 0
      },         
      {
        "type": "select",
        "id": "modal_image_ratio",
        "label": "Aspect ratio",
        "default": "portrait",
        "options": [
          {
            "label": "Portrait",
            "value": "portrait"
          },
          {
            "label": "Square",
            "value": "square"
          },
          {
            "label": "Landscape",
            "value": "landscape"
          },
          {
            "label": "Original",
            "value": "original"
          }
        ]
      },
      {
        "type": "select",
        "id": "modal_image_ratio_mobile",
        "label": "Aspect ratio - mobile",
        "default": "portrait",
        "options": [
          {
            "label": "Portrait",
            "value": "portrait"
          },
          {
            "label": "Square",
            "value": "square"
          },
          {
            "label": "Landscape",
            "value": "landscape"
          },
          {
            "label": "Original",
            "value": "original"
          }
        ]
      },
      {
        "type": "header",
        "content": "Modal author's image settings"
      },
      {
        "type": "range",
        "id": "modal_circle_size",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Size",
        "default": 30
      },
      {
        "type": "range",
        "id": "modal_circle_size_mobile",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Size - mobile",
        "default": 30
      },
      {
        "type": "range",
        "id": "modal_circle_border_thickness",
        "min": 0,
        "max": 10,
        "step": 1,
        "unit": "px",
        "label": "Border thickness",
        "default": 1
      },
      {
        "type": "header",
        "content": "Modal author settings"
      },
      {
        "type": "checkbox",
        "id": "author_custom",
        "label": "Use custom font",
        "default": false
      },
      {
        "type": "font_picker",
        "id": "author_font",
        "label": "Font family",
        "default": "josefin_sans_n4"
      },
      {
        "type": "range",
        "id": "author_size",
        "min": 0,
        "max": 40,
        "step": 1,
        "unit": "px",
        "label": "Font size",
        "default": 13
      },
      {
        "type": "range",
        "id": "author_size_mobile",
        "min": 0,
        "max": 40,
        "step": 1,
        "unit": "px",
        "label": "Font size - mobile",
        "default": 13
      },
      {
        "type": "range",
        "id": "author_height",
        "min": 50,
        "max": 200,
        "step": 10,
        "unit": "%",
        "label": "Line height",
        "default": 130
      },
      {
        "type": "header",
        "content": "Modal text settings"
      },
      {
        "type": "checkbox",
        "id": "text_custom",
        "label": "Use custom font",
        "default": false
      },
      {
        "type": "font_picker",
        "id": "text_font",
        "label": "Font family",
        "default": "josefin_sans_n4"
      },
      {
        "type": "range",
        "id": "text_size",
        "min": 0,
        "max": 40,
        "step": 1,
        "unit": "px",
        "label": "Font size",
        "default": 16
      },
      {
        "type": "range",
        "id": "text_size_mobile",
        "min": 0,
        "max": 40,
        "step": 1,
        "unit": "px",
        "label": "Font size - mobile",
        "default": 16
      },
      {
        "type": "range",
        "id": "text_height",
        "min": 50,
        "max": 200,
        "step": 10,
        "unit": "%",
        "label": "Line height",
        "default": 150
      },
      {
        "type": "header",
        "content": "Modal toggle products settings"
      },
      {
        "type": "text",
        "id": "toggle_text",
        "label": "Toggle show text",
        "default": "Show products +"
      },
      {
        "type": "text",
        "id": "toggle_hide_text",
        "label": "Toggle hide text",
        "default": "Hide products -"
      },
      {
        "type": "checkbox",
        "id": "toggle_custom",
        "label": "Use custom font",
        "default": false
      },
      {
        "type": "font_picker",
        "id": "toggle_font",
        "label": "Font family",
        "default": "josefin_sans_n4"
      },
      {
        "type": "range",
        "id": "toggle_size",
        "min": 0,
        "max": 40,
        "step": 1,
        "unit": "px",
        "label": "Font size",
        "default": 14
      },
      {
        "type": "range",
        "id": "toggle_size_mobile",
        "min": 0,
        "max": 40,
        "step": 1,
        "unit": "px",
        "label": "Font size - mobile",
        "default": 14
      },
      {
        "type": "range",
        "id": "toggle_height",
        "min": 50,
        "max": 200,
        "step": 10,
        "unit": "%",
        "label": "Line height",
        "default": 130
      },
      {
        "type": "range",
        "id": "toggle_mt",
        "min": 0,
        "max": 50,
        "step": 2,
        "unit": "px",
        "label": "Margin top",
        "default": 20
      },
      {
        "type": "range",
        "id": "toggle_mt_mobile",
        "min": 0,
        "max": 50,
        "step": 2,
        "unit": "px",
        "label": "Margin top - mobile",
        "default": 20
      },
      {
        "type": "header",
        "content": "Modal buttons settings"
      },
      {
        "type": "range",
        "id": "modal_buttons_size",
        "min": 10,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Size",
        "default": 40
      },
      {
        "type": "range",
        "id": "modal_buttons_size_mobile",
        "min": 10,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Size - mobile",
        "default": 40
      },
      {
        "type": "checkbox",
        "id": "modal_arrow_show_desktop",
        "label": "Show modal arrows on desktop",
        "default": false
      },
      {
        "type": "checkbox",
        "id": "modal_arrow_show_mobile",
        "label": "Show modal arrows on mobile",
        "default": false
      },
      {
        "type": "header",
        "content": "Product cards settings"
      },
      {
        "type": "text_alignment",
        "id": "product_cards_align",
        "label": "Alignment"
      },
      {
        "type": "range",
        "id": "product_cards_gap",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Gap",
        "default": 10
      },
      {
        "type": "range",
        "id": "product_cards_gap_mobile",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Gap - mobile",
        "default": 10
      },
      {
        "type": "header",
        "content": "Product card settings"
      },
      {
        "type": "range",
        "id": "product_card_width",
        "min": 100,
        "max": 300,
        "step": 10,
        "unit": "px",
        "label": "Width",
        "default": 250
      },
      {
        "type": "range",
        "id": "product_card_width_mobile",
        "min": 50,
        "max": 300,
        "step": 10,
        "unit": "px",
        "label": "Width - mobile",
        "default": 200
      },
      {
        "type": "range",
        "id": "product_card_radius",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Roundness",
        "default": 0
      },
      {
        "type": "range",
        "id": "product_card_border_thickness",
        "min": 0,
        "max": 10,
        "step": 1,
        "unit": "px",
        "label": "Border thickness",
        "default": 1
      },
      {
        "type": "header",
        "content": "Product image settings"
      },
      {
        "type": "select",
        "id": "product_image_ratio",
        "label": "Aspect ratio",
        "default": "square",
        "options": [
          {
            "label": "Portrait",
            "value": "portrait"
          },
          {
            "label": "Square",
            "value": "square"
          },
          {
            "label": "Landscape",
            "value": "landscape"
          },
          {
            "label": "Original",
            "value": "original"
          }
        ]
      },
      {
        "type": "select",
        "id": "product_image_ratio_mobile",
        "label": "Aspect ratio - mobile",
        "default": "square",
        "options": [
          {
            "label": "Portrait",
            "value": "portrait"
          },
          {
            "label": "Square",
            "value": "square"
          },
          {
            "label": "Landscape",
            "value": "landscape"
          },
          {
            "label": "Original",
            "value": "original"
          }
        ]
      },
      {
        "type": "header",
        "content": "Product title settings"
      },
      {
        "type": "checkbox",
        "id": "title_custom",
        "label": "Use custom font",
        "default": false
      },
      {
        "type": "font_picker",
        "id": "title_font",
        "label": "Font family",
        "default": "josefin_sans_n4"
      },
      {
        "type": "range",
        "id": "title_size",
        "min": 0,
        "max": 40,
        "step": 1,
        "unit": "px",
        "label": "Font size",
        "default": 14
      },
      {
        "type": "range",
        "id": "title_size_mobile",
        "min": 0,
        "max": 40,
        "step": 1,
        "unit": "px",
        "label": "Font size - mobile",
        "default": 14
      },
      {
        "type": "range",
        "id": "title_height",
        "min": 50,
        "max": 200,
        "step": 10,
        "unit": "%",
        "label": "Line height",
        "default": 150
      },
      {
        "type": "range",
        "id": "title_mt",
        "min": 0,
        "max": 50,
        "step": 2,
        "unit": "px",
        "label": "Margin top",
        "default": 10
      },
      {
        "type": "range",
        "id": "title_mt_mobile",
        "min": 0,
        "max": 50,
        "step": 2,
        "unit": "px",
        "label": "Margin top - mobile",
        "default": 10
      },
      {
        "type": "header",
        "content": "Product details settings"
      },
      {
        "type": "checkbox",
        "id": "details_custom",
        "label": "Use custom font",
        "default": false
      },
      {
        "type": "font_picker",
        "id": "details_font",
        "label": "Font family",
        "default": "josefin_sans_n4"
      },
      {
        "type": "range",
        "id": "details_size",
        "min": 0,
        "max": 40,
        "step": 1,
        "unit": "px",
        "label": "Font size",
        "default": 13
      },
      {
        "type": "range",
        "id": "details_size_mobile",
        "min": 0,
        "max": 40,
        "step": 1,
        "unit": "px",
        "label": "Font size - mobile",
        "default": 13
      },
      {
        "type": "range",
        "id": "details_height",
        "min": 50,
        "max": 200,
        "step": 10,
        "unit": "%",
        "label": "Line height",
        "default": 150
      },
      {
        "type": "range",
        "id": "details_mt",
        "min": 0,
        "max": 50,
        "step": 2,
        "unit": "px",
        "label": "Margin top",
        "default": 10
      },
      {
        "type": "range",
        "id": "details_mt_mobile",
        "min": 0,
        "max": 50,
        "step": 2,
        "unit": "px",
        "label": "Margin top - mobile",
        "default": 10
      },
      {
        "type": "header",
        "content": "Thumbnail colors"
      },
      {
        "type": "color",
        "label": "Border",
        "id": "slide_border_color",
        "default": "#000000"
      },
      {
        "type": "header",
        "content": "Arrow colors"
      },
      {
        "type": "color",
        "label": "Icon",
        "id": "arrow_color",
        "default": "#7B7B7B"
      },
      {
        "type": "color",
        "label": "Icon hover",
        "id": "arrow_hover_color",
        "default": "#7B7B7B"
      },
      {
        "type": "color",
        "label": "Background",
        "id": "arrow_bg_color"
      },
      {
        "type": "color",
        "label": "Background hover",
        "id": "arrow_bg_hover_color"
      },
      {
        "type": "color",
        "label": "Border",
        "id": "arrow_border_color",
        "default": "#C7C7C7"
      },
      {
        "type": "color",
        "label": "Border hover",
        "id": "arrow_border_hover_color",
        "default": "#C7C7C7"
      },
      {
        "type": "header",
        "content": "Modal colors"
      },
      {
        "type": "color",
        "label": "Overlay",
        "id": "modal_overlay_color",
        "default": "#ECECEC"
      },
      {
        "type": "color",
        "label": "Buttons icon",
        "id": "modal_buttons_icon_color",
        "default": "#FFFFFF"
      },
      {
        "type": "header",
        "content": "Modal slide colors"
      },
      {
        "type": "color",
        "label": "Circle border",
        "id": "modal_circle_border_color",
        "default": "#FFFFFF"
      },
      {
        "type": "color",
        "label": "Author",
        "id": "author_color",
        "default": "#FFFFFF"
      },
      {
        "type": "color",
        "label": "Text",
        "id": "text_color",
        "default": "#FFFFFF"
      },
      {
        "type": "color",
        "label": "Toggle",
        "id": "toggle_color",
        "default": "#5b24c9"
      },
      {
        "type": "header",
        "content": "Products modal colors"
      },
      {
        "type": "color",
        "label": "Background",
        "id": "products_modal_bg_color",
        "default": "#FFFFFF"
      },
      {
        "type": "color",
        "label": "Overlay",
        "id": "products_modal_overlay_color",
        "default": "#515151"
      },
      {
        "type": "header",
        "content": "Product card colors"
      },
      {
        "type": "color",
        "label": "Background",
        "id": "product_card_bg_color",
        "default": "#FFFFFF"
      },
      {
        "type": "color",
        "label": "Border",
        "id": "product_card_border_color",
        "default": "#EEEEEE"
      },
      {
        "type": "color",
        "label": "Title",
        "id": "title_color",
        "default": "#212121"
      },
      {
        "type": "color",
        "label": "Title hover",
        "id": "title_hover_color",
        "default": "#5b24c9"
      },
      {
        "type": "color",
        "label": "Details",
        "id": "details_color",
        "default": "#b4b4b4"
      },
      {
        "type": "header",
        "content": "Section colors"
      },
      {
        "type": "color",
        "label": "Heading",
        "id": "heading_color",
        "default": "#000000"
      },
      {
        "type": "color",
        "label": "Section background",
        "id": "background_color",
        "default": "#FFFFFF"
      },
      {
        "type": "color_background",
        "id": "background_gradient",
        "label": "Section background gradient"
      },
      {
        "type": "color",
        "label": "Border",
        "id": "border_color",
        "default": "#000000"
      },
      {
        "type": "header",
        "content": "Section margin (outside)"
      },
      {
        "type": "range",
        "id": "margin_top",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Margin top",
        "default": 0
      },
      {
        "type": "range",
        "id": "margin_bottom",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Margin bottom",
        "default": 0
      },
      {
        "type": "range",
        "id": "margin_horizontal",
        "min": 0,
        "max": 30,
        "step": 1,
        "unit": "rem",
        "label": "Margin sides",
        "default": 0
      },
      {
        "type": "range",
        "id": "margin_horizontal_mobile",
        "min": 0,
        "max": 15,
        "step": 0.5,
        "unit": "rem",
        "label": "Margin sides mobile",
        "default": 0
      },
      {
        "type": "header",
        "content": "Section padding (inside)"
      },
      {
        "type": "range",
        "id": "padding_top",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Padding top",
        "default": 36
      },
      {
         "type": "range",
         "id": "padding_bottom",
         "min": 0,
         "max": 100,
         "step": 4,
         "unit": "px",
         "label": "Padding bottom",
         "default": 36
      },
      {
        "type": "range",
        "id": "padding_horizontal",
        "min": 0,
        "max": 30,
        "step": 1,
        "unit": "rem",
        "label": "Padding sides",
        "default": 5
      },
      {
        "type": "range",
        "id": "padding_horizontal_mobile",
        "min": 0,
        "max": 15,
        "step": 0.5,
        "unit": "rem",
        "label": "Padding sides mobile",
        "default": 1.5
      },
      {
        "type": "header",
        "content": "Section settings"
      },
      {
        "type": "checkbox",
        "id": "full_width",
        "label": "Full width",
        "default": false
      },
      {
        "type": "range",
        "id": "content_width",
        "min": 800,
        "max": 2000,
        "step": 100,
        "unit": "px",
        "label": "Section content width",
        "default": 800
      },
      {
        "type": "range",
        "id": "border_thickness",
        "min": 0,
        "max": 50,
        "step": 1,
        "unit": "px",
        "label": "Border thickness",
        "default": 0
      },
      {
        "type": "range",
        "id": "section_radius",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Section roundness",
        "default": 0
      },
      {
        "type": "checkbox",
        "id": "lazy",
        "label": "Lazy load",
        "info": "Lazy load images for speed optimisation",
        "default": true
      }
    ],
    "blocks": [
      {
        "type": "image",
        "name": "Image",
        "settings": [
          {
            "type": "image_picker",
            "id": "image",
            "label": "Image"
          },
          {
            "type": "image_picker",
            "id": "circle_image",
            "label": "Thumbnail",
            "info": "Leave blank to use main image"
          },
          {
            "type": "text",
            "id": "author",
            "label": "Author",
            "default": "Author"
          },
          {
            "type": "text",
            "id": "text",
            "label": "Text",
            "default": "Tell your story"
          },
          {
            "type": "product_list",
            "id": "products",
            "label": "Products"
          },
        ]
      }
    ],
    "presets": [
      {
        "name": "SS - Instafeed #8",
        "blocks": [
          {
            "type": "image"
          },
          {
            "type": "image"
          },
          {
            "type": "image"
          },
          {
            "type": "image"
          },
          {
            "type": "image"
          },
          {
            "type": "image"
          },
          {
            "type": "image"
          }
        ]
      }
    ]
  }
{% endschema %}