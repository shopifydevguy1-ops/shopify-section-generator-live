{%- liquid 
  assign padding_horizontal = section.settings.padding_horizontal
  assign padding_horizontal_mobile = section.settings.padding_horizontal_mobile
  assign padding_top = section.settings.padding_top
  assign padding_bottom = section.settings.padding_bottom
  assign border_color = section.settings.border_color
  assign border_thickness = section.settings.border_thickness
  assign margin_top = section.settings.margin_top
  assign margin_bottom = section.settings.margin_bottom
  assign margin_horizontal_mobile = section.settings.margin_horizontal_mobile
  assign margin_horizontal = section.settings.margin_horizontal
  assign background_color = section.settings.background_color
  assign background_gradient = section.settings.background_gradient
  assign full_width = section.settings.full_width
  assign content_width = section.settings.content_width
  assign lazy = section.settings.lazy
  assign section_radius = section.settings.section_radius

  assign collection_view = section.settings.collection_view

  assign use_articles = section.settings.use_articles
  assign blog = section.settings.blog
  assign blog_posts = section.settings.blog_posts

  assign body_gap_mobile = section.settings.body_gap_mobile
  assign body_gap = section.settings.body_gap

  assign card_border_color = section.settings.card_border_color
  assign card_border_thickness = section.settings.card_border_thickness
  assign card_radius = section.settings.card_radius
  assign card_overlay_color = section.settings.card_overlay_color
  assign card_overlay = section.settings.card_overlay
  assign card_shadow = section.settings.card_shadow
  assign card_padding_vertical = section.settings.card_padding_vertical
  assign card_padding_vertical_mobile = section.settings.card_padding_vertical_mobile
  assign card_padding_horizontal = section.settings.card_padding_horizontal
  assign card_padding_horizontal_mobile = section.settings.card_padding_horizontal_mobile

  assign content_bg_color = section.settings.content_bg_color
  assign content_vertical_position = section.settings.content_vertical_position
  assign content_vertical_position_mobile = section.settings.content_vertical_position_mobile
  assign content_padding_vertical = section.settings.content_padding_vertical
  assign content_padding_vertical_mobile = section.settings.content_padding_vertical_mobile
  assign content_padding_horizontal = section.settings.content_padding_horizontal
  assign content_padding_horizontal_mobile = section.settings.content_padding_horizontal_mobile
  assign content_border_color = section.settings.content_border_color
  assign content_border_thickness = section.settings.content_border_thickness
  assign content_radius = section.settings.content_radius
  assign content_horizontal_align_mobile = section.settings.content_horizontal_align_mobile
  assign content_horizontal_align = section.settings.content_horizontal_align

  assign tag_radius = section.settings.tag_radius
  assign tag_padding_vertical = section.settings.tag_padding_vertical
  assign tag_padding_horizontal = section.settings.tag_padding_horizontal
  assign tag_bg_color = section.settings.tag_bg_color
  assign tag_size = section.settings.tag_size
  assign tag_size_mobile = section.settings.tag_size_mobile
  assign tag_color = section.settings.tag_color
  assign tag_custom = section.settings.tag_custom
  assign tag_font = section.settings.tag_font
  assign tag_height = section.settings.tag_height

  assign heading_size = section.settings.heading_size
  assign heading_size_mobile = section.settings.heading_size_mobile
  assign heading_color = section.settings.heading_color
  assign heading_custom = section.settings.heading_custom
  assign heading_font = section.settings.heading_font
  assign heading_height = section.settings.heading_height
  assign heading_mt = section.settings.heading_mt

  assign text_align = ""
  if content_horizontal_align == "start"
    assign text_align = "left"
  elsif content_horizontal_align == "center"
    assign text_align = "center"
  else
    assign text_align = "right"
  endif

  assign text_align_mobile = ""
  if content_horizontal_align_mobile == "start"
    assign text_align_mobile = "left"
  elsif content_horizontal_align_mobile == "center"
    assign text_align_mobile = "center"
  else
    assign text_align_mobile = "right"
  endif

-%}

{%- style -%}

  {{  tag_font | font_face: font_display: 'swap' }}
  {{  heading_font | font_face: font_display: 'swap' }}
  
  .section-{{ section.id }} {
    border-top: solid {{ border_color }} {{ border_thickness }}px;
    border-bottom: solid {{ border_color }} {{ border_thickness }}px;
    margin-top: {{ margin_top | times: 0.75 | round: 0 }}px;
    margin-bottom: {{ margin_bottom | times: 0.75 | round: 0 }}px;
    margin-left: {{ margin_horizontal_mobile }}rem;
    margin-right: {{ margin_horizontal_mobile }}rem;
    border-radius: {{ section_radius | times: 0.6 | round: 0 }}px;
  }
  
  .section-{{ section.id }}-settings {
    margin: 0 auto;
    padding-top: {{ padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ padding_bottom | times: 0.75 | round: 0 }}px;
    padding-left: {{ padding_horizontal_mobile }}rem;
    padding-right: {{ padding_horizontal_mobile }}rem;
  }

  .collection-body-mobile-{{ section.id }} {
    display: grid;
    grid-template-columns: 1fr;
    gap: {{ body_gap_mobile }}px;
  }

  .collection-body-{{ section.id }} {
    display: none;
  }

  .collection-body-tablet-{{ section.id }} {
    display: none;
  }

  .collection-item-{{ section.id }} {
    padding: {{ card_padding_vertical_mobile }}px {{ card_padding_horizontal_mobile }}px;
    border: {{ card_border_thickness }}px solid {{ card_border_color }};
    border-radius: {{ card_radius }}px;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    justify-content: {{ content_vertical_position_mobile }};
    aspect-ratio: 9.6/12; 
    text-decoration: none;
  }

  .collection-body-mobile-{{ section.id }} .collection-item-{{ section.id }}:nth-child(even) {
    aspect-ratio: 9.6/15; 
  }

  .collection-body-tablet-{{ section.id }} .collection-column-{{ section.id }}:last-child .collection-item-{{ section.id }}:nth-child(odd) {
    aspect-ratio: 9.6/15; 
  }

  .collection-body-{{ section.id }} .collection-column-{{ section.id }}:first-child .collection-item-{{ section.id }}:nth-child(even),
  .collection-body-{{ section.id }} .collection-column-{{ section.id }}:last-child .collection-item-{{ section.id }}:nth-child(even){
     aspect-ratio: 9.6/15; 
  }

  .collection-body-{{ section.id }} .collection-column-{{ section.id }}:nth-child(2) .collection-item-{{ section.id }}:nth-child(odd) {
     aspect-ratio: 9.6/15; 
  }

  .collection-image-{{ section.id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
  }

  .collection-image-{{ section.id }}:after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
    background-color: {{ card_overlay_color |  hex_to_rgba: card_overlay }};
  }

  .collection-image-{{ section.id }} img,
  .collection-image-{{ section.id }} svg {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .collection-image-{{ section.id }} svg {
    background-color: #AFAFAF;
  }

  .collection-content-{{ section.id }} {
    position: relative;
    z-index: 2;
    width: 100%;
    padding: {{ content_padding_vertical_mobile }}px {{ content_padding_horizontal_mobile }}px;
    border: {{ content_border_thickness }}px solid {{ content_border_color }};
    border-radius: {{ content_radius }}px;
    background-color: {{ content_bg_color }};
    display: flex;
    flex-direction: column;
    align-items: {{ content_horizontal_align_mobile }};
  }

  .collection-tag-{{ section.id }} {
    width: 100%;
    max-width: fit-content;
    margin: 0px;
    padding: {{ tag_padding_vertical }}px {{ tag_padding_horizontal }}px;
    border-radius: {{ tag_radius }}px;
    background-color: {{ tag_bg_color }};
    font-size: {{ tag_size_mobile }}px;
    color: {{ tag_color }};
    line-height: {{ tag_height }}%;
    text-transform: unset;
  }

  .collection-heading-{{ section.id }} {
    text-align: {{ text_align_mobile }};
    margin-top: {{ heading_mt | times: 0.75 | round: 0 }}px;
  }

  .collection-heading-{{ section.id }} * {
    margin: 0;
    font-size: {{ heading_size_mobile }}px;
    color: {{ heading_color }};
    line-height: {{ heading_height }}%;
    text-transform: unset;
  }

  .collection-column-{{ section.id }} {
    display: grid;
    grid-template-columns: 1fr;
    gap: {{ body_gap_mobile }}px;
  }

  @media(min-width: 768px) {
    .collection-body-tablet-{{ section.id }} {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: {{ body_gap_mobile }}px;
      align-items: start;
    }

    .collection-body-mobile-{{ section.id }} {
      display: none;
    }
  }
  
  @media(min-width: 1024px) {

    .collection-body-tablet-{{ section.id }} {
      gap: {{ body_gap }}px;
    }

    .section-{{ section.id }} {
      margin-top: {{ margin_top }}px;
      margin-bottom: {{ margin_bottom }}px;
      margin-left: {{ margin_horizontal }}rem;
      margin-right: {{ margin_horizontal }}rem;
      border-radius: {{ section_radius }}px;
    }
    
    .section-{{ section.id }}-settings {
      padding: 0 5rem;
      padding-top: {{ padding_top }}px;
      padding-bottom: {{ padding_bottom }}px;
      padding-left: {{ padding_horizontal }}rem;
      padding-right: {{ padding_horizontal }}rem;
    }

    .collection-body-tablet-{{ section.id }} {
      display: none;
    }
    
    .collection-body-{{ section.id }} {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: {{ body_gap }}px;
      align-items: start;
    }

    .collection-item-{{ section.id }} {
        padding: {{ card_padding_vertical }}px {{ card_padding_horizontal }}px;
        justify-content: {{ content_vertical_position }};
    }

    .collection-content-{{ section.id }} {
        padding: {{ content_padding_vertical }}px {{ content_padding_horizontal }}px;
        align-items: {{ content_horizontal_align }};
    }

    .collection-tag-{{ section.id }} {
        font-size: {{ tag_size }}px;
    }

    .collection-heading-{{ section.id }} {
        text-align: {{ text_align }};
        margin-top: {{ heading_mt }}px;
    }

    .collection-heading-{{ section.id }} * {
        font-size: {{ heading_size }}px;
    }

    .collection-column-{{ section.id }} {
      gap: {{ body_gap }}px;
    }
  }
  
{%- endstyle -%}

{% unless full_width %}
  <style>
    .section-{{ section.id }}-settings {
        max-width: {{ content_width }}rem;
    }
  </style>
{% endunless %}

{% if tag_custom %}
    <style>
        .collection-tag-{{ section.id }} {
            font-family: {{ tag_font.family }}, {{ tag_font.fallback_families }};
            font-weight: {{ tag_font.weight }};
            font-style: {{ tag_font.style }};
        }
    </style>
{% endif %}

{% if heading_custom %}
    <style>
        .collection-heading-{{ section.id }} * {
            font-family: {{ heading_font.family }}, {{ heading_font.fallback_families }};
            font-weight: {{ heading_font.weight }};
            font-style: {{ heading_font.style }};
        }
    </style>
{% endif %}

{% if card_shadow %}
    <style>
        .collection-item-{{ section.id }} {
            box-shadow: rgba(0, 0, 0, 0.08) 0px 4px 12px;
        }
    </style>
{% endif %}

{% if text_align_mobile == "center" %}
    <style>
        .collection-tag-{{ section.id }} {
            margin-left: auto;
            margin-right: auto;
        } 
    </style>
{% elsif text_align_mobile == "right" %}
    <style>
        .collection-tag-{{ section.id }} {
            margin-left: auto;
        } 
    </style>
{% endif %}
  
{% if text_align == "center" %}
    <style>
        @media(min-width: 1024px) {
            .collection-tag-{{ section.id }} {
                margin-left: auto !important;
                margin-right: auto !important;
            } 
        }
    </style>
{% elsif text_align == "right" %}
    <style>
        @media(min-width: 1024px) {
            .collection-tag-{{ section.id }} {
                margin-left: auto !important;
                margin-right: 0px !important;
            } 
        }
    </style>
{% else %}
    <style>
        @media(min-width: 1024px) {
            .collection-tag-{{ section.id }} {
                margin-left: 0px !important;
                margin-right: 0px !important;
            } 
        }
    </style>
{% endif %}

{% if margin_horizontal_mobile > 0 %}
  <style>
    .section-{{ section.id }} {
      border-left: solid {{ border_color }} {{ border_thickness }}px;
      border-right: solid {{ border_color }} {{ border_thickness }}px;
    }
    
    @media(min-width: 1024px) {
      .section-{{ section.id }} {
        border-left: 0px;
        border-right: 0px;
      }
    }
  </style>
{% endif %}

{% if margin_horizontal > 0 %}
  <style>
    @media(min-width: 1024px) {
      .section-{{ section.id }} {
        border-left: solid {{ border_color }} {{ border_thickness }}px;
        border-right: solid {{ border_color }} {{ border_thickness }}px;
      }
    }
  </style>
{% endif %}

<div class="section-{{ section.id }} collection-{{ section.id }}" style="background-color:{{ background_color }}; background-image: {{ background_gradient }};">
    <div class="section-{{ section.id }}-settings">
        <div class="collection-body-mobile-{{ section.id }}">
          {% if use_articles and blog != blank %}
            {% for article in blog.articles limit: blog_posts %}
              <a href="{{ article.url }}" class="collection-item-{{ section.id }}">
                  <div class="collection-image-{{ section.id }}">
                      {% if article.image != blank %}
                          <img src="{{ article.image | image_url }}" alt="{{ article.image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                      {% else %}
                          {{ 'image' |  placeholder_svg_tag }}
                      {% endif %}
                  </div>
                  <div class="collection-content-{{ section.id }}">
                      {% if article.tags != blank %}
                          {% for tag in article.tags %}
                            {% if forloop.first %}
                              <p class="collection-tag-{{ section.id }}">{{ tag }}</p>
                            {% endif %}
                          {% endfor %}
                      {% endif %}
                      <div class="collection-heading-{{ section.id }}">
                          <h3>{{ article.title }}</h3>
                      </div>
                  </div>
              </a>
            {% endfor %}
          {% else %}
            {% if collection_view > 0 %}
              {% for collection in collections limit: collection_view %}
                <a href="{{ collection.url }}" class="collection-item-{{ section.id }}">
                    <div class="collection-image-{{ section.id }}">
                        {% if collection.featured_image != blank %}
                            <img src="{{ collection.featured_image | image_url }}" alt="{{ collection.featured_image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                        {% else %}
                            {{ 'image' |  placeholder_svg_tag }}
                        {% endif %}
                    </div>
                    <div class="collection-content-{{ section.id }}">
                        {% if collection.all_tags != blank %}
                            {% for tag in collection.all_tags %}
                              {% if forloop.first %}
                                <p class="collection-tag-{{ section.id }}">{{ tag }}</p>
                              {% endif %}
                            {% endfor %}
                        {% endif %}
                        <div class="collection-heading-{{ section.id }}">
                            <h3>{{ collection.title }}</h3>
                        </div>
                    </div>
                </a>
              {% endfor %}
            {% else %}
              {% for block in section.blocks %}
                <{% if block.settings.url != blank %}a href="{{ block.settings.url }}"{% else %}div{% endif %} class="collection-item-{{ section.id }}">
                    <div class="collection-image-{{ section.id }}">
                        {% if block.settings.image != blank %}
                            <img src="{{ block.settings.image | image_url }}" alt="{{ block.settings.image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                        {% else %}
                            {{ 'image' |  placeholder_svg_tag }}
                        {% endif %}
                    </div>
                    <div class="collection-content-{{ section.id }}">
                        {% if block.settings.tag != blank %}
                            <p class="collection-tag-{{ section.id }}">{{ block.settings.tag }}</p>
                        {% endif %}
                        {% if block.settings.heading != blank %}
                            <div class="collection-heading-{{ section.id }}">
                                {{ block.settings.heading }}
                            </div>
                        {% endif %}
                    </div>
                </{% if block.settings.url != blank %}a{% else %}div{% endif %}>
              {% endfor %}
            {% endif %}
          {% endif %}
        </div>
        <div class="collection-body-tablet-{{ section.id }}">
          {% if use_articles and blog != blank %}
            {% assign half_articles_count = blog_posts | times: 0.5 | round: 0 %}
            <div class="collection-column-{{ section.id }}">
              {% for article in blog.articles %}
                {% if forloop.index <= half_articles_count %}
                  <a href="{{ article.url }}" class="collection-item-{{ section.id }}">
                      <div class="collection-image-{{ section.id }}">
                          {% if article.image != blank %}
                              <img src="{{ article.image | image_url }}" alt="{{ article.image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                          {% else %}
                              {{ 'image' |  placeholder_svg_tag }}
                          {% endif %}
                      </div>
                      <div class="collection-content-{{ section.id }}">
                          {% if article.tags != blank %}
                              {% for tag in article.tags %}
                                {% if forloop.first %}
                                  <p class="collection-tag-{{ section.id }}">{{ tag }}</p>
                                {% endif %}
                              {% endfor %}
                          {% endif %}
                          <div class="collection-heading-{{ section.id }}">
                              <h3>{{ article.title }}</h3>
                          </div>
                      </div>
                  </a>
                {% endif %}
              {% endfor %}
            </div>
            <div class="collection-column-{{ section.id }}">
              {% for article in blog.articles %}
                {% if forloop.index > half_articles_count %}
                  <a href="{{ article.url }}" class="collection-item-{{ section.id }}">
                      <div class="collection-image-{{ section.id }}">
                          {% if article.image != blank %}
                              <img src="{{ article.image | image_url }}" alt="{{ article.image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                          {% else %}
                              {{ 'image' |  placeholder_svg_tag }}
                          {% endif %}
                      </div>
                      <div class="collection-content-{{ section.id }}">
                          {% if article.tags != blank %}
                              {% for tag in article.tags %}
                                {% if forloop.first %}
                                  <p class="collection-tag-{{ section.id }}">{{ tag }}</p>
                                {% endif %}
                              {% endfor %}
                          {% endif %}
                          <div class="collection-heading-{{ section.id }}">
                              <h3>{{ article.title }}</h3>
                          </div>
                      </div>
                  </a>
                {% endif %}
              {% endfor %}
            </div>
          {% else %}
            {% if collection_view > 0 %}
              {% assign half_collections_count = 0 %}
              {% if collections.size < collection_view %}
                {% assign half_collections_count = collections.size | times: 0.5 | round: 0 %}
              {% else %}
                {% assign half_collections_count = collection_view | times: 0.5 | round: 0 %}
              {% endif %}
            
              <div class="collection-column-{{ section.id }}">
                {% for collection in collections %}
                  {% if forloop.index <= half_collections_count %}
                    <a href="{{ collection.url }}" class="collection-item-{{ section.id }}">
                      <div class="collection-image-{{ section.id }}">
                          {% if collection.featured_image != blank %}
                              <img src="{{ collection.featured_image | image_url }}" alt="{{ collection.featured_image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                          {% else %}
                              {{ 'image' |  placeholder_svg_tag }}
                          {% endif %}
                      </div>
                      <div class="collection-content-{{ section.id }}">
                          {% if collection.all_tags != blank %}
                              {% for tag in collection.all_tags %}
                                {% if forloop.first %}
                                  <p class="collection-tag-{{ section.id }}">{{ tag }}</p>
                                {% endif %}
                              {% endfor %}
                          {% endif %}
                          <div class="collection-heading-{{ section.id }}">
                              <h3>{{ collection.title }}</h3>
                          </div>
                      </div>
                    </a>
                  {% endif %}
                {% endfor %}
              </div>
              <div class="collection-column-{{ section.id }}">
                {% for collection in collections %}
                  {% if forloop.index > half_collections_count %}
                    <a href="{{ collection.url }}" class="collection-item-{{ section.id }}">
                      <div class="collection-image-{{ section.id }}">
                          {% if collection.featured_image != blank %}
                              <img src="{{ collection.featured_image | image_url }}" alt="{{ collection.featured_image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                          {% else %}
                              {{ 'image' |  placeholder_svg_tag }}
                          {% endif %}
                      </div>
                      <div class="collection-content-{{ section.id }}">
                          {% if collection.all_tags != blank %}
                              {% for tag in collection.all_tags %}
                                {% if forloop.first %}
                                  <p class="collection-tag-{{ section.id }}">{{ tag }}</p>
                                {% endif %}
                              {% endfor %}
                          {% endif %}
                          <div class="collection-heading-{{ section.id }}">
                              <h3>{{ collection.title }}</h3>
                          </div>
                      </div>
                    </a>
                  {% endif %}
                {% endfor %}
              </div>
            {% else %}
              {% assign blocks_count = section.blocks.size %}
              {% assign half_block_count = blocks_count | times: 0.5 | round: 0 %}
              <div class="collection-column-{{ section.id }}">
                {% for block in section.blocks %}
                  {% if forloop.index <= half_block_count %}
                    <{% if block.settings.url != blank %}a href="{{ block.settings.url }}"{% else %}div{% endif %} class="collection-item-{{ section.id }}">
                        <div class="collection-image-{{ section.id }}">
                            {% if block.settings.image != blank %}
                                <img src="{{ block.settings.image | image_url }}" alt="{{ block.settings.image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                            {% else %}
                                {{ 'image' |  placeholder_svg_tag }}
                            {% endif %}
                        </div>
                        <div class="collection-content-{{ section.id }}">
                            {% if block.settings.tag != blank %}
                                <p class="collection-tag-{{ section.id }}">{{ block.settings.tag }}</p>
                            {% endif %}
                            {% if block.settings.heading != blank %}
                                <div class="collection-heading-{{ section.id }}">
                                    {{ block.settings.heading }}
                                </div>
                            {% endif %}
                        </div>
                      </{% if block.settings.url != blank %}a{% else %}div{% endif %}>
                  {% endif %}
                {% endfor %}
              </div>
              <div class="collection-column-{{ section.id }}">
                {% for block in section.blocks %}
                  {% if forloop.index > half_block_count %}
                    <{% if block.settings.url != blank %}a href="{{ block.settings.url }}"{% else %}div{% endif %} class="collection-item-{{ section.id }}">
                        <div class="collection-image-{{ section.id }}">
                            {% if block.settings.image != blank %}
                                <img src="{{ block.settings.image | image_url }}" alt="{{ block.settings.image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                            {% else %}
                                {{ 'image' |  placeholder_svg_tag }}
                            {% endif %}
                        </div>
                        <div class="collection-content-{{ section.id }}">
                            {% if block.settings.tag != blank %}
                                <p class="collection-tag-{{ section.id }}">{{ block.settings.tag }}</p>
                            {% endif %}
                            {% if block.settings.heading != blank %}
                                <div class="collection-heading-{{ section.id }}">
                                    {{ block.settings.heading }}
                                </div>
                            {% endif %}
                        </div>
                      </{% if block.settings.url != blank %}a{% else %}div{% endif %}>
                  {% endif %}
                {% endfor %}
              </div>
            {% endif %}
          {% endif %}
        </div>
        <div class="collection-body-{{ section.id }}">
          {% if use_articles and blog != blank %}

            {% assign per_column = blog_posts | divided_by: 3 %}
            {% assign per_column_2 = per_column | times: 2 %}
            {% assign remainder = blog_posts | modulo: 3 %}
            {% assign per_column_remainder = per_column | plus: remainder %}

            <div class="collection-column-{{ section.id }}">
              {% for article in blog.articles limit: per_column %}
                <a href="{{ article.url }}" class="collection-item-{{ section.id }}">
                    <div class="collection-image-{{ section.id }}">
                        {% if article.image != blank %}
                            <img src="{{ article.image | image_url }}" alt="{{ article.image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                        {% else %}
                            {{ 'image' |  placeholder_svg_tag }}
                        {% endif %}
                    </div>
                    <div class="collection-content-{{ section.id }}">
                        {% if article.tags != blank %}
                            {% for tag in article.tags %}
                              {% if forloop.first %}
                                <p class="collection-tag-{{ section.id }}">{{ tag }}</p>
                              {% endif %}
                            {% endfor %}
                        {% endif %}
                        <div class="collection-heading-{{ section.id }}">
                            <h3>{{ article.title }}</h3>
                        </div>
                    </div>
                </a>
              {% endfor %}
            </div>
            
            <div class="collection-column-{{ section.id }}">
              {% for article in blog.articles offset:per_column limit:per_column %}
                <a href="{{ article.url }}" class="collection-item-{{ section.id }}">
                    <div class="collection-image-{{ section.id }}">
                        {% if article.image != blank %}
                            <img src="{{ article.image | image_url }}" alt="{{ article.image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                        {% else %}
                            {{ 'image' |  placeholder_svg_tag }}
                        {% endif %}
                    </div>
                    <div class="collection-content-{{ section.id }}">
                        {% if article.tags != blank %}
                            {% for tag in article.tags %}
                              {% if forloop.first %}
                                <p class="collection-tag-{{ section.id }}">{{ tag }}</p>
                              {% endif %}
                            {% endfor %}
                        {% endif %}
                        <div class="collection-heading-{{ section.id }}">
                            <h3>{{ article.title }}</h3>
                        </div>
                    </div>
                </a>
              {% endfor %}
            </div>

            <div class="collection-column-{{ section.id }}">
              {% for article in blog.articles offset:per_column_2 limit:per_column_remainder %}
                <a href="{{ article.url }}" class="collection-item-{{ section.id }}">
                    <div class="collection-image-{{ section.id }}">
                        {% if article.image != blank %}
                            <img src="{{ article.image | image_url }}" alt="{{ article.image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                        {% else %}
                            {{ 'image' |  placeholder_svg_tag }}
                        {% endif %}
                    </div>
                    <div class="collection-content-{{ section.id }}">
                        {% if article.tags != blank %}
                            {% for tag in article.tags %}
                              {% if forloop.first %}
                                <p class="collection-tag-{{ section.id }}">{{ tag }}</p>
                              {% endif %}
                            {% endfor %}
                        {% endif %}
                        <div class="collection-heading-{{ section.id }}">
                            <h3>{{ article.title }}</h3>
                        </div>
                    </div>
                </a>
              {% endfor %}
            </div>
            
          {% else %}
            {% if collection_view > 0 %}
              {% assign per_column = 0 %}
              {% assign per_column_2 = 0 %}
              {% assign per_column_remainder = 0 %}
              {% if collections.size < collection_view %}
                {% assign per_column = collections.size | divided_by: 3 %}
                {% assign per_column_2 = per_column | times: 2 %}
                {% assign remainder = collections.size | modulo: 3 %}
                {% assign per_column_remainder = per_column | plus: remainder %}
              {% else %}
                {% assign per_column = collection_view | divided_by: 3 %}
                {% assign per_column_2 = per_column | times: 2 %}
                {% assign remainder = collection_view | modulo: 3 %}
                {% assign per_column_remainder = per_column | plus: remainder %}
              {% endif %}
              
              
              <div class="collection-column-{{ section.id }}">
                {% for collection in collections limit: per_column %}
                  <a href="{{ collection.url }}" class="collection-item-{{ section.id }}">
                    <div class="collection-image-{{ section.id }}">
                        {% if collection.featured_image != blank %}
                            <img src="{{ collection.featured_image | image_url }}" alt="{{ collection.featured_image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                        {% else %}
                            {{ 'image' |  placeholder_svg_tag }}
                        {% endif %}
                    </div>
                    <div class="collection-content-{{ section.id }}">
                        {% if collection.all_tags != blank %}
                            {% for tag in collection.all_tags %}
                              {% if forloop.first %}
                                <p class="collection-tag-{{ section.id }}">{{ tag }}</p>
                              {% endif %}
                            {% endfor %}
                        {% endif %}
                        <div class="collection-heading-{{ section.id }}">
                            <h3>{{ collection.title }}</h3>
                        </div>
                    </div>
                  </a>
                {% endfor %}
              </div>
              <div class="collection-column-{{ section.id }}">
                {% for collection in collections offset:per_column limit:per_column %}
                   <a href="{{ collection.url }}" class="collection-item-{{ section.id }}">
                      <div class="collection-image-{{ section.id }}">
                          {% if collection.featured_image != blank %}
                              <img src="{{ collection.featured_image | image_url }}" alt="{{ collection.featured_image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                          {% else %}
                              {{ 'image' |  placeholder_svg_tag }}
                          {% endif %}
                      </div>
                      <div class="collection-content-{{ section.id }}">
                          {% if collection.all_tags != blank %}
                              {% for tag in collection.all_tags %}
                                {% if forloop.first %}
                                  <p class="collection-tag-{{ section.id }}">{{ tag }}</p>
                                {% endif %}
                              {% endfor %}
                          {% endif %}
                          <div class="collection-heading-{{ section.id }}">
                              <h3>{{ collection.title }}</h3>
                          </div>
                      </div>
                    </a> 
                {% endfor %}
              </div>
              <div class="collection-column-{{ section.id }}">
                {% for collection in collections offset:per_column_2 limit:per_column_remainder %}
                    <a href="{{ collection.url }}" class="collection-item-{{ section.id }}">
                      <div class="collection-image-{{ section.id }}">
                          {% if collection.featured_image != blank %}
                              <img src="{{ collection.featured_image | image_url }}" alt="{{ collection.featured_image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                          {% else %}
                              {{ 'image' |  placeholder_svg_tag }}
                          {% endif %}
                      </div>
                      <div class="collection-content-{{ section.id }}">
                          {% if collection.all_tags != blank %}
                              {% for tag in collection.all_tags %}
                                {% if forloop.first %}
                                  <p class="collection-tag-{{ section.id }}">{{ tag }}</p>
                                {% endif %}
                              {% endfor %}
                          {% endif %}
                          <div class="collection-heading-{{ section.id }}">
                              <h3>{{ collection.title }}</h3>
                          </div>
                      </div>
                    </a> 
                {% endfor %}
              </div>
            {% else %}
              {% assign per_column = blocks_count | divided_by: 3 %}
              {% assign per_column_2 = per_column | times: 2 %}
              {% assign remainder = blocks_count | modulo: 3 %}
              {% assign per_column_remainder = per_column | plus: remainder %}
              <div class="collection-column-{{ section.id }}">
                {% for block in section.blocks limit: per_column %}
                  <{% if block.settings.url != blank %}a href="{{ block.settings.url }}"{% else %}div{% endif %} class="collection-item-{{ section.id }}">
                      <div class="collection-image-{{ section.id }}">
                          {% if block.settings.image != blank %}
                              <img src="{{ block.settings.image | image_url }}" alt="{{ block.settings.image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                          {% else %}
                              {{ 'image' |  placeholder_svg_tag }}
                          {% endif %}
                      </div>
                      <div class="collection-content-{{ section.id }}">
                          {% if block.settings.tag != blank %}
                              <p class="collection-tag-{{ section.id }}">{{ block.settings.tag }}</p>
                          {% endif %}
                          {% if block.settings.heading != blank %}
                              <div class="collection-heading-{{ section.id }}">
                                  {{ block.settings.heading }}
                              </div>
                          {% endif %}
                      </div>
                    </{% if block.settings.url != blank %}a{% else %}div{% endif %}>
                {% endfor %}
              </div>
              <div class="collection-column-{{ section.id }}">
                {% for block in section.blocks offset:per_column limit:per_column %}
                  <{% if block.settings.url != blank %}a href="{{ block.settings.url }}"{% else %}div{% endif %} class="collection-item-{{ section.id }}">
                      <div class="collection-image-{{ section.id }}">
                          {% if block.settings.image != blank %}
                              <img src="{{ block.settings.image | image_url }}" alt="{{ block.settings.image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                          {% else %}
                              {{ 'image' |  placeholder_svg_tag }}
                          {% endif %}
                      </div>
                      <div class="collection-content-{{ section.id }}">
                          {% if block.settings.tag != blank %}
                              <p class="collection-tag-{{ section.id }}">{{ block.settings.tag }}</p>
                          {% endif %}
                          {% if block.settings.heading != blank %}
                              <div class="collection-heading-{{ section.id }}">
                                  {{ block.settings.heading }}
                              </div>
                          {% endif %}
                      </div>
                    </{% if block.settings.url != blank %}a{% else %}div{% endif %}>
                {% endfor %}
              </div>
  
              <div class="collection-column-{{ section.id }}">
                {% for block in section.blocks offset:per_column_2 limit:per_column_remainder %}
                  <{% if block.settings.url != blank %}a href="{{ block.settings.url }}"{% else %}div{% endif %} class="collection-item-{{ section.id }}">
                    <div class="collection-image-{{ section.id }}">
                        {% if block.settings.image != blank %}
                            <img src="{{ block.settings.image | image_url }}" alt="{{ block.settings.image.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                        {% else %}
                            {{ 'image' |  placeholder_svg_tag }}
                        {% endif %}
                    </div>
                    <div class="collection-content-{{ section.id }}">
                        {% if block.settings.tag != blank %}
                            <p class="collection-tag-{{ section.id }}">{{ block.settings.tag }}</p>
                        {% endif %}
                        {% if block.settings.heading != blank %}
                            <div class="collection-heading-{{ section.id }}">
                                {{ block.settings.heading }}
                            </div>
                        {% endif %}
                    </div>
                  </{% if block.settings.url != blank %}a{% else %}div{% endif %}>
                {% endfor %}
              </div>
            {% endif %}
          {% endif %}
        </div>
    </div>
</div>

{% schema %}
{
  "name": "SG-Collection List",
  "settings": [
    {
      "type": "header",
      "content": "Collection Settings"
    },
    {
      "type": "range",
      "id": "collection_view",
      "min": 0,
      "max": 30,
      "step": 1,
      "label": "Collections to Show",
      "info": "Set to 0 to use block items / custom images & text",
      "default": 0
    },
    {
      "type": "header",
      "content": "Blog Settings"
    },
    {
      "type": "checkbox",
      "id": "use_articles",
      "label": "Use Blog Articles"
    },
    {
      "type": "blog",
      "id": "blog",
      "label": "Blog"
    },
    {
      "type": "range",
      "id": "blog_posts",
      "min": 1,
      "max": 30,
      "step": 1,
      "label": "Blog Articles",
      "default": 6
    },
    {
      "type": "header",
      "content": "Body Settings"
    },
    {
      "type": "range",
      "id": "body_gap",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Body Gap",
      "default": 40
    },
    {
      "type": "range",
      "id": "body_gap_mobile",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Body Gap - Mobile",
      "default": 16
    },
    {
      "type": "header",
      "content": "Card Settings"
    },
    {
      "type": "range",
      "id": "card_padding_vertical",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Card Padding Vertical",
      "default": 16
    },
    {
      "type": "range",
      "id": "card_padding_vertical_mobile",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Card Padding Vertical - Mobile",
      "default": 16
    },
    {
      "type": "range",
      "id": "card_padding_horizontal",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Card Padding Horizontal",
      "default": 16
    },
    {
      "type": "range",
      "id": "card_padding_horizontal_mobile",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Card Padding Horizontal - Mobile",
      "default": 16
    },
    {
      "type": "range",
      "id": "card_radius",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Card Roundness",
      "default": 8
    },
    {
      "type": "range",
      "id": "card_border_thickness",
      "min": 0,
      "max": 10,
      "step": 1,
      "unit": "px",
      "label": "Card Border Thickness",
      "default": 0
    },
    {
      "type": "range",
      "id": "card_overlay",
      "min": 0,
      "max": 1,
      "step": 0.1,
      "label": "Card Overlay Opacity",
      "default": 0
    },
    {
      "type": "checkbox",
      "id": "card_shadow",
      "label": "Card Shadow"
    },
    {
      "type": "header",
      "content": "Card Content Settings"
    },
    {
      "type": "select",
      "id": "content_vertical_position",
      "label": "Content Vertical Position",
      "default": "end",
      "options": [
        {
          "label": "Top",
          "value": "start"
        },
        {
          "label": "Center",
          "value": "center"
        },
        {
          "label": "Bottom",
          "value": "end"
        }
      ]
    },
    {
      "type": "select",
      "id": "content_vertical_position_mobile",
      "label": "Content Vertical Position - Mobile",
      "default": "end",
      "options": [
        {
          "label": "Top",
          "value": "start"
        },
        {
          "label": "Center",
          "value": "center"
        },
        {
          "label": "Bottom",
          "value": "end"
        }
      ]
    },
    {
      "type": "select",
      "id": "content_horizontal_align",
      "label": "Content Horizontal",
      "default": "start",
      "options": [
        {
          "label": "Left",
          "value": "start"
        },
        {
          "label": "Center",
          "value": "center"
        },
        {
          "label": "Right",
          "value": "bottom"
        }
      ]
    },
    {
      "type": "select",
      "id": "content_horizontal_align_mobile",
      "label": "Content Horizontal - Mobile",
      "default": "start",
      "options": [
        {
          "label": "Left",
          "value": "start"
        },
        {
          "label": "Center",
          "value": "center"
        },
        {
          "label": "Right",
          "value": "bottom"
        }
      ]
    },
    {
      "type": "range",
      "id": "content_padding_vertical",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Content Padding Vertical",
      "default": 16
    },
    {
      "type": "range",
      "id": "content_padding_vertical_mobile",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Content Padding Vertical - Mobile",
      "default": 16
    },
    {
      "type": "range",
      "id": "content_padding_horizontal",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Content Padding Horizontal",
      "default": 16
    },
    {
      "type": "range",
      "id": "content_padding_horizontal_mobile",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Content Padding Horizontal - Mobile",
      "default": 16
    },
    {
      "type": "range",
      "id": "content_radius",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Content Roundness",
      "default": 8
    },
    {
      "type": "range",
      "id": "content_border_thickness",
      "min": 0,
      "max": 10,
      "step": 1,
      "unit": "px",
      "label": "Content Border Thickness",
      "default": 0
    },
    {
      "type": "header",
      "content": "Card Tag Settings"
    },
    {
      "type": "range",
      "id": "tag_padding_vertical",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Card Tag Padding Vertical",
      "default": 6
    },
    {
      "type": "range",
      "id": "tag_padding_horizontal",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Card Tag Padding Horizontal",
      "default": 6
    },
    {
      "type": "range",
      "id": "tag_radius",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Card Tag Roundness",
      "default": 4
    },
    {
      "type": "checkbox",
      "id": "tag_custom",
      "label": "Use Custom Font",
      "default": false
    },
    {
      "type": "font_picker",
      "id": "tag_font",
      "label": "Card Tag Font Family",
      "default": "josefin_sans_n4"
    },
    {
      "type": "range",
      "id": "tag_size",
      "min": 0,
      "max": 30,
      "step": 1,
      "unit": "px",
      "label": "Card Tag Size",
      "default": 12
    },
    {
      "type": "range",
      "id": "tag_size_mobile",
      "min": 0,
      "max": 30,
      "step": 1,
      "unit": "px",
      "label": "Card Tag Size - Mobile",
      "default": 12
    },
    {
      "type": "range",
      "id": "tag_height",
      "min": 50,
      "max": 200,
      "step": 10,
      "unit": "%",
      "label": "Card Tag Line Height",
      "default": 100
    },
    {
      "type": "header",
      "content": "Card Heading Settings"
    },
    {
      "type": "checkbox",
      "id": "heading_custom",
      "label": "Use Custom Font",
      "default": false
    },
    {
      "type": "font_picker",
      "id": "heading_font",
      "label": "Heading Font Family",
      "default": "josefin_sans_n4"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 0,
      "max": 72,
      "step": 2,
      "unit": "px",
      "label": "Heading Size",
      "default": 26
    },
    {
      "type": "range",
      "id": "heading_size_mobile",
      "min": 0,
      "max": 72,
      "step": 2,
      "unit": "px",
      "label": "Heading Size - Mobile",
      "default": 18
    },
    {
      "type": "range",
      "id": "heading_height",
      "min": 50,
      "max": 200,
      "step": 10,
      "unit": "%",
      "label": "Heading Line Height",
      "default": 130
    },
    {
      "type": "range",
      "id": "heading_mt",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Heading Margin Top",
      "default": 12
    },
    {
      "type": "header",
      "content": "Card Colors"
    },
    {
      "type": "color",
      "label": "Card Border Color",
      "id": "card_border_color",
      "default": "#000000"
    },
    {
      "type": "color",
      "label": "Card Overlay Color",
      "id": "card_overlay_color",
      "default": "#000000"
    },
    {
      "type": "color",
      "label": "Card Content Background Color",
      "id": "content_bg_color",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "label": "Card Content Border Color",
      "id": "content_border_color",
      "default": "#000000"
    },
    {
      "type": "color",
      "label": "Card Tag Background Color",
      "id": "tag_bg_color",
      "default": "#F4EEE6"
    },
    {
      "type": "color",
      "label": "Card Tag Color",
      "id": "tag_color",
      "default": "#000000"
    },
    {
      "type": "color",
      "label": "Card Heading Color",
      "id": "heading_color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Section Colors"
    },
    {
      "type": "color",
      "label": "Section background",
      "id": "background_color",
      "default": "#FFFFFF"
    },
    {
      "type": "color_background",
      "id": "background_gradient",
      "label": "Section background gradient"
    },
    {
      "type": "color",
      "label": "Border",
      "id": "border_color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Section margin (outside)"
    },
    {
      "type": "range",
      "id": "margin_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Margin top",
      "default": 0
    },
    {
      "type": "range",
      "id": "margin_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Margin bottom",
      "default": 0
    },
    {
      "type": "range",
      "id": "margin_horizontal",
      "min": 0,
      "max": 30,
      "step": 1,
      "unit": "rem",
      "label": "Margin sides",
      "default": 3
    },
    {
      "type": "range",
      "id": "margin_horizontal_mobile",
      "min": 0,
      "max": 15,
      "step": 0.5,
      "unit": "rem",
      "label": "Margin sides mobile",
      "default": 1.5
    },
    {
      "type": "header",
      "content": "Section padding (inside)"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding bottom",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_horizontal",
      "min": 0,
      "max": 30,
      "step": 1,
      "unit": "rem",
      "label": "Padding sides",
      "default": 5
    },
    {
      "type": "range",
      "id": "padding_horizontal_mobile",
      "min": 0,
      "max": 15,
      "step": 0.5,
      "unit": "rem",
      "label": "Padding sides mobile",
      "default": 1.5
    },
    {
      "type": "header",
      "content": "Section Settings"
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Full Width",
      "default": false
    },
    {
      "type": "range",
      "id": "content_width",
      "min": 0,
      "max": 400,
      "step": 10,
      "unit": "rem",
      "label": "Section content width",
      "default": 120
    },
    {
      "type": "range",
      "id": "border_thickness",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Border thickness",
      "default": 0
    },
    {
      "type": "range",
      "id": "section_radius",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Section Roundness",
      "default": 0
    },
    {
      "type": "checkbox",
      "id": "lazy",
      "label": "Lazy load",
      "info": "Lazy load images for speed optimisation",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "item",
      "name": "Item",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "tag",
          "label": "Tag",
          "default": "Tag"
        },
        {
          "type": "richtext",
          "id": "heading",
          "label": "Heading",
          "default": "<h3>Heading</h3>"
        },
        {
          "type": "url",
          "id": "url",
          "label": "URL"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "SG-Collection List",
      "blocks": [
        {
          "type": "item",
          "settings": {
            "tag": "Tag",
            "heading": "<h2>Heading</h2>"
          }
        },
        {
          "type": "item",
          "settings": {
            "tag": "Tag",
            "heading": "<h2>Heading</h2>"
          }
        },
        {
          "type": "item",
          "settings": {
            "tag": "Tag",
            "heading": "<h2>Heading</h2>"
          }
        },
        {
          "type": "item",
          "settings": {
            "tag": "Tag",
            "heading": "<h2>Heading</h2>"
          }
        },
        {
          "type": "item",
          "settings": {
            "tag": "Tag",
            "heading": "<h2>Heading</h2>"
          }
        },
        {
          "type": "item",
          "settings": {
            "tag": "Tag",
            "heading": "<h2>Heading</h2>"
          }
        },
        {
          "type": "item",
          "settings": {
            "tag": "Tag",
            "heading": "<h2>Heading</h2>"
          }
        },
        {
          "type": "item",
          "settings": {
            "tag": "Tag",
            "heading": "<h2>Heading</h2>"
          }
        },
        {
          "type": "item",
          "settings": {
            "tag": "Tag",
            "heading": "<h2>Heading</h2>"
          }
        }
      ]
    }
  ]
}
{% endschema %}