{
  "id": "before-after-image",
  "name": "Before & After",
  "description": "Section: Before & After",
  "tags": [
    "before"
  ],
  "type": "custom",
  "liquid_code": "<style>\n  .section-{{ section.id }}-wrapper {\n    padding-top: var(--pt);\n    padding-bottom: var(--pb);\n    direction: ltr;\n  }\n\n  @media screen and (min-width: 750px) {\n    .section-{{ section.id }}-wrapper {\n      padding-top: var(--pt-desktop);\n      padding-bottom: var(--pb-desktop);\n    }\n  }\n  .section-{{ section.id }} {\n    max-width: var(--max-width, 120rem);\n    margin: 0 auto;\n    padding: 0 1.5rem;\n  }\n  @media screen and (min-width: 750px) {\n    .section-{{ section.id }} {\n        padding: 0 5rem;\n    }\n  }\n</style>\n<div\n  class=\"section-{{ section.id }}-wrapper\"\n  style=\"\n    --pt: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;\n    --pt-desktop: {{ section.settings.padding_top }}px;\n    --pb: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;\n    --pb-desktop: {{ section.settings.padding_bottom }}px;\n    --max-width: {{ section.settings.section-width }}rem;\n    background-color: {{ section.settings.background_color }};\n    background: {{ section.settings.background }};\n  \"\n>\n  <div\n    class=\"section-{{ section.id }}\"\n  >\n    <div\n      style=\"border-radius: {{ section.settings.border_radius }}px;\"\n    >\n      {% for block in section.blocks %}\n        {% case block.type %}\n          {% when 'text' %}\n            <style>\n              .text-{{ block.id }} * {\n                color: var(--color);\n                text-align: var(--text-align);\n              }\n            </style>\n            <div\n              class=\"text-{{ block.id }}\"\n              style=\"\n                --text-align: {{ block.settings.text_position }};\n                --color: {{ block.settings.color }};\n              \"\n            >\n              {% if block.settings.subheading != blank %}\n                <p\n                  style=\"font-weight: bold;\"\n                >\n                  {{ block.settings.subheading }}\n                </p>\n              {% endif %}\n              {% if block.settings.heading != blank %}\n                <h2\n                  style=\"font-weight: 700;\"\n                >\n                  {{ block.settings.heading }}\n                </h2>\n              {% endif %}\n              {% if block.settings.content != blank %}\n                <div style=\"margin-bottom:10px;\">\n                  {{ block.settings.content }}\n                </div>\n              {% endif %}\n            </div>\n          {% when 'images' %}\n            <style>\n              .section-{{ section.id }}  .before-after-image-wrapper {\n                position: relative;\n                --text-primary: 26 26 26;\n                --shadow: 0 5px 15px rgb(var(--text-primary) / 0.1);\n                filter: drop-shadow(var(--shadow));\n                user-select: none;\n                overflow: hidden;\n              }\n              .section-{{ section.id }} .filter-invert {\n                filter: invert(1);\n              }\n              .section-{{ section.id }} .placeholder {\n                --text-primary: 26 26 26;\n                background: rgb(var(--text-primary) / .3);\n                fill: rgb(var(--text-primary) / .7);\n                color: rgb(var(--text-primary) / .7);\n                display: block;\n              }\n              .section-{{ section.id }} .before-after-image-text {\n                position: absolute;\n                font-weight: 700;\n              }\n              .section-{{ section.id }} .bg-text {\n                background: white;\n              }\n              .section-{{ section.id }} .before-after-image {\n                width: 100%;\n                display: block;\n              }\n              .section-{{ section.id }} .before-after-image--cover {\n                height: 100%;\n                object-fit: cover;\n                object-position: center;\n              }\n              .section-{{ section.id }} .before-after-image-relative {\n                height: var(--mobile-height);\n              }\n              @media screen and (min-width: 750px) {\n                .section-{{ section.id }} .before-after-image-relative {\n                  height: var(--desktop-height);\n                }\n              }\n            </style>\n            <div\n              class=\"before-after-image-wrapper\"\n              style=\"\n                --before-after-initial-drag-position: {{ block.settings.drag_initial_position }}%;\n                --clip-path-offset: 0px;\n                border-radius: {{ block.settings.border_radius }}px;\n              \"\n            >\n              {% assign before_image = block.settings.before_image %}\n              {% assign after_image = block.settings.after_image %}\n              <div\n                class=\"before-after-image-relative\"\n                style=\"\n                  position: relative;\n                  color: {{ block.settings.before_text_color }};\n                  --mobile-height: {{ block.settings.mobile_height }}px;\n                  --desktop-height: {{ block.settings.desktop_height }}px;\n                \"\n              >\n                {% if before_image != blank %}\n                  <img\n                    src=\"{{ before_image | img_url: 'master' }}\"\n                    alt=\"{{ before_image.alt }}\"\n                    srcset=\"\n                      {{ before_image | img_url: '300x' }} 300w,\n                      {{ before_image | img_url: '400x' }} 400w,\n                      {{ before_image | img_url: '500x' }} 500w,\n                      {{ before_image | img_url: '600x' }} 600w,\n                      {{ before_image | img_url: '800x' }} 800w,\n                      {{ before_image | img_url: '1000x' }} 1000w,\n                      {{ before_image | img_url: '1200x' }} 1200w,\n                      {{ before_image | img_url: '1400x' }} 1400w\n                    \"\n                    {% comment %} width=\"1512\" {% endcomment %}\n                    {% comment %} height=\"900\" {% endcomment %}\n                    {% comment %} sizes=\"(max-width: 999px) 100vw, 1000px\" {% endcomment %}\n                    loading=\"lazy\"\n                    draggable=\"false\"\n                    class=\"\n                      before-after-image\n                      {% if block.settings.cover %} before-after-image--cover {% endif %}\n                    \"\n                  >\n                {% else %}\n                  {{\n                    'lifestyle-1'\n                    | placeholder_svg_tag: 'placeholder before-after-image--cover'\n                  }}\n                {% endif %}\n                {% if block.settings.before_text != blank %}\n                  <div\n                    class=\"before-after-image-text before-after-image-text--before\"\n                    style=\"\n                      color: {{ block.settings.before_text_color }};\n                      left: 2rem;\n                      {% if block.settings.before_after_text_position == 'bottom' %}\n                        bottom: 1rem;\n                      {% else %}\n                        top: 1rem;\n                      {% endif %}\n                    \"\n                  >\n                    {{ block.settings.before_text }}\n                  </div>\n                {% endif %}\n              </div>\n              <div\n                style=\"\n                  clip-path: inset(0 0 0 calc(var(--before-after-initial-drag-position, 50%) + var(--clip-path-offset, 0px)));\n                  position: absolute;\n                  top: 0;\n                  bottom: 0;\n                  left: 0;\n                  right: 0;\n                  color: {{ block.settings.after_text_color }};\n                \"\n              >\n                {% if after_image != blank %}\n                  <img\n                    src=\"{{ after_image | img_url: 'master' }}\"\n                    alt=\"{{ after_image.alt }}\"\n                    srcset=\"\n                      {{ after_image | img_url: '300x' }} 300w,\n                      {{ after_image | img_url: '400x' }} 400w,\n                      {{ after_image | img_url: '500x' }} 500w,\n                      {{ after_image | img_url: '600x' }} 600w,\n                      {{ after_image | img_url: '800x' }} 800w,\n                      {{ after_image | img_url: '1000x' }} 1000w,\n                      {{ after_image | img_url: '1200x' }} 1200w,\n                      {{ after_image | img_url: '1400x' }} 1400w\n                    \"\n                    {% comment %} width=\"1512\" {% endcomment %}\n                    {% comment %} height=\"900\" {% endcomment %}\n                    {% comment %} sizes=\"(max-width: 999px) 100vw, 1000px\" {% endcomment %}\n                    loading=\"lazy\"\n                    draggable=\"false\"\n                    class=\"\n                      before-after-image\n                      {% if block.settings.cover %} before-after-image--cover {% endif %}\n                    \"\n                  >\n                {% else %}\n                  {{\n                    'lifestyle-2'\n                    | placeholder_svg_tag: 'filter-invert bg-text before-after-image--cover'\n                  }}\n                {% endif %}\n                {% if block.settings.after_text != blank %}\n                  <div\n                    class=\"before-after-image-text before-after-image-text--after\"\n                    style=\"\n                      color: {{ block.settings.after_text_color }};\n                      right: 2rem;\n                      {% if block.settings.before_after_text_position == 'bottom' %}\n                        bottom: 1rem;\n                      {% else %}\n                        top: 1rem;\n                      {% endif %}\n                    \"\n                  >\n                    {{ block.settings.after_text }}\n                  </div>\n                {% endif %}\n              </div>\n              {% comment %} Cursor: {% endcomment %}\n              <style>\n                .section-{{ section.id }} .before-after__cursor {\n                  height: 100%;\n                  width: max-content;\n                  touch-action: none;\n                  --transform-logical-flip: 1;\n                  transform: translate(calc(var(--transform-logical-flip) * -50% + var(--clip-path-offset, 0px)),-50%);\n                  cursor: grab;\n                  filter: drop-shadow(0 1px 2px #0000001a) drop-shadow(0 1px 1px #0000000f);\n                  will-change: transform;\n                  place-items: center;\n                  display: grid;\n                  position: relative;\n                  top: 50%;\n                  left: var(--before-after-initial-drag-position, 0px);\n                }\n                .section-{{ section.id }} .before-after__cursor:before {\n                  content: '';\n                  height: 100%;\n                  width: 2px;\n                  background: var(--background);\n                  z-index: -1;\n                  position: absolute;\n                }\n              </style>\n              <div\n                style=\"\n                  position: absolute;\n                  top: 0;\n                  bottom: 0;\n                  left: 0;\n                  right: 0;\n                \"\n              >\n                <split-cursor\n                  class=\"before-after__cursor\"\n                  style=\"--background: {{ block.settings.drag_cursor_bg }}; \"\n                >\n                  <svg\n                    role=\"presentation\"\n                    focusable=\"false\"\n                    width=\"28\"\n                    height=\"35\"\n                    viewBox=\"0 0 32 40\"\n                    style=\"width: 40px; height: 40px;\"\n                  >\n                    <path d=\"M0 16C0 7.16344 7.16344 0 16 0C24.8366 0 32 7.16344 32 16V24C32 32.8366 24.8366 40 16 40C7.16344 40 0 32.8366 0 24V16Z\"\n                      fill=\"{{ block.settings.drag_cursor_bg }}\"></path>\n                    <path fill=\"{{ block.settings.drag_cursor_color }}\" d=\"M11 14H13V26H11zM15 14H17V26H15zM19 14H21V26H19z\"></path>\n                  </svg>\n                </split-cursor>\n              </div>\n              <script>\n                (function () {\n                  function setup() {\n                    const cursor = document.querySelector(\n                      '.section-{{ section.id }} .before-after__cursor'\n                    );\n                    const imageWrapper = document.querySelector(\n                      '.section-{{ section.id }} .before-after-image-wrapper'\n                    );\n\n                    // drag the cursor to update the imageWrapper's --clip-path-offset value (px)\n                    let xStart, xEnd, xDiff, originalOffset;\n                    function dragStart(event) {\n                      xStart = event.clientX;\n                      originalOffset = imageWrapper.style\n                        .getPropertyValue('--clip-path-offset')\n                        .slice(0, -2);\n                      //xStart = imageWrapper.style\n                      //  .getPropertyValue('--clip-path-offset')\n                      //  .slice(0, -2);\n                      document.addEventListener('pointermove', dragMove);\n                      document.addEventListener('pointerup', dragEnd);\n                    }\n\n                    function dragMove(event) {\n                      xEnd = event.clientX;\n                      xDiff = xEnd - xStart;\n\n                      // clamp the value to the imageWrapper's 1/2 width\n                      let result = xDiff + parseInt(originalOffset);\n                      let cursorOffsetPercent = parseFloat(getComputedStyle(imageWrapper).getPropertyValue('--before-after-initial-drag-position'));\n                      let containerWidth = imageWrapper.offsetWidth;\n                      let pixelsOffset = (cursorOffsetPercent / 100) * containerWidth;\n                      \n                      const negativeMax = -1 * (pixelsOffset);\n                      const positiveMax = imageWrapper.offsetWidth - pixelsOffset;\n                      if (result < negativeMax) {\n                        result = negativeMax;\n                      } else if (result > positiveMax) {\n                        result = positiveMax;\n                      }\n                      imageWrapper.style.setProperty(\n                        '--clip-path-offset',\n                        result + 'px'\n                      );\n                    }\n\n                    function dragEnd(event) {\n                      document.removeEventListener('pointermove', dragMove);\n                      document.removeEventListener('pointerup', dragEnd);\n                    }\n\n                    cursor.addEventListener('pointerdown', dragStart);\n                  }\n                  setup();\n                  if (Shopify.designMode) {\n                    document.addEventListener('shopify:section:load', setup);\n                  }\n                })();\n              </script>\n            </div>\n          {% when 'button' %}\n            {% if block.settings.link_text != blank %}\n              <style>\n                .before-after-atc-button-{{ section.id }} {\n                  display: block;\n                  text-decoration: none;\n                  text-align: center;\n                  color: var(--color);\n                  background-color: var(--background-color);\n                  border-style: solid;\n                  transition: all 0.3s ease-in-out;\n                  margin-top: 30px;\n                }\n                @media screen and (min-width: 750px) {\n                  .before-after-atc-button-{{ section.id }} {\n                    margin-top: 40px;\n                  }\n                }\n                .before-after-atc-button-{{ section.id }}:hover {\n                  color: var(--hover-color);\n                  background-color: var(--hover-background-color);\n                }\n              </style>\n              <a\n                href=\"{{ block.settings.link }}\"\n                class=\"before-after-atc-button-{{ section.id }}\"\n                style=\"\n                  width: {{ block.settings.width }}px;\n                  --color: {{ block.settings.color }};\n                  --background-color: {{ block.settings.background_color }};\n                  --hover-color: {{ block.settings.hover_color }};\n                  --hover-background-color: {{ block.settings.hover_background_color }};\n                  font-size: {{ block.settings.font_size }}px;\n                  border-radius: {{ block.settings.border_radius }}px;\n                  border-color: {{ block.settings.border_color }};\n                  border-width: {{ block.settings.border_width }}px;\n                  padding: 6px 0;\n                  {% case block.settings.button_position %}\n                    {% when 'left' %}\n                      float: left;\n                      margin-right: 20px;\n                    {% when 'right' %}\n                      float: right;\n                      margin-left: 20px;\n                    {% else %}\n                      margin-left: auto;\n                      margin-right: auto;\n                  {% endcase %}\n                \"\n              >\n                {{ block.settings.link_text }}\n              </a>\n            {% endif %}\n          {% else %}\n\n        {% endcase %}\n      {% endfor %}\n    </div>\n  </div>\n</div>",
  "variables": {
    "background_color": {
      "type": "color",
      "default": "transparent",
      "label": "Background Color",
      "description": "Background Color"
    },
    "background": {
      "type": "color",
      "default": "",
      "label": "Background",
      "description": "Background"
    },
    "padding_top": {
      "type": "text",
      "default": "36",
      "label": "Padding top",
      "description": "Padding top"
    },
    "padding_bottom": {
      "type": "text",
      "default": "36",
      "label": "Padding bottom",
      "description": "Padding bottom"
    },
    "section-width": {
      "type": "text",
      "default": "120",
      "label": "Section width",
      "description": "Section width"
    }
  }
}