{
  "id": "countdown-insert",
  "name": "CUSTOM Countdown timer bar",
  "description": "Section: CUSTOM Countdown timer bar",
  "tags": [
    "countdown"
  ],
  "type": "custom",
  "liquid_code": "<template\n  id=\"countdown-timer-{{ section.id }}\"\n>\n  <div>\n    <style>\n      .countdown-banner-{{ section.id }}-wrapper {\n        padding-top: var(--pt);\n        padding-bottom: var(--pb);\n      }\n      @media screen and (min-width: 750px) {\n        .countdown-banner-{{ section.id }}-wrapper {\n          padding-top: var(--pt-desktop);\n          padding-bottom: var(--pb-desktop);\n        }\n      }\n      .countdown-banner-{{ section.id }} {\n        position: relative;\n        height: var(--section-height-mobile);\n        overflow: hidden;\n      }\n      @media screen and (min-width: 750px) {\n        .countdown-banner-{{ section.id }} {\n          height: var(--section-height);\n        }\n      }\n    </style>\n    <div\n      style=\"\n        --pt: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;\n        --pt-desktop: {{ section.settings.padding_top }}px;\n        --pb: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;\n        --pb-desktop: {{ section.settings.padding_bottom }}px;\n        background-color:{{ section.settings.background-color }};\n        position: relative;\n      \"\n      id=\"countdown-banner-{{ section.id }}-wrapper\"\n    >\n      <div\n        class=\"\n          countdown-banner-{{ section.id }}\n          {% unless section.settings.full_width %} page-width {% endunless %}\n        \"\n        style=\"\n          --section-height: {{ section.settings.height }};\n          --section-height-mobile: {{ section.settings.height_mobile }};\n        \"\n      >\n        <div\n          style=\"\"\n        >\n          {% comment %} Content: {% endcomment %}\n          <style>\n            .countdown-banner-content-{{ section.id }} {\n              position: relative;\n              z-index: 1;\n              overflow: hidden;\n              width: 100%;\n              height: 100%;\n              display: flex;\n              flex-wrap: wrap;\n              justify-content: center;\n              align-items: center;\n              gap: 1rem;\n              text-align: center;\n              line-height: 1.1;\n              padding: 16px 5px;\n            }\n\n            @media (min-width: 750px) {\n              .countdown-banner-content-{{ section.id }} {\n                gap:3rem;\n              }\n            }\n          </style>\n          <div\n            class=\"countdown-banner-content-{{ section.id }}\"\n          >\n            {% for block in section.blocks %}\n              {% case block.type %}\n                {% when 'text' %}\n                  {% if block.settings.heading != blank %}\n                    <style>\n                      .countdown-banner-heading-{{ section.id }}-{{ block.id }} {\n                        font-weight: 700;\n                        font-size: {{ block.settings.font_size | times: 0.85 | round: 0  }}px;\n                      }\n                      @media (min-width: 750px) {\n                        .countdown-banner-heading-{{ section.id }}-{{ block.id }} {\n                          font-weight: 700;\n                          font-size: {{ block.settings.font_size }}px;\n                        }\n                      }\n                    </style>\n                    <div\n                      class=\"countdown-banner-heading-{{ section.id }}-{{ block.id }}\"\n                      style=\"\n                                                                                                                                                                                                                        color: {{ block.settings.color }};\n                      \"\n                    >\n                      {{ block.settings.heading }}\n                    </div>\n                  {% endif %}\n                {% when 'timer' %}\n                  <div\n                    class=\"timer-div-{{ section.id }}\"\n                    style=\"\n                      display: flex;\n                      justify-content: center;\n                      align-items: center;\n                    \"\n                  >\n                    <style>\n                      .timer-div-{{ section.id }} {\n                        gap:2rem;\n                      }\n                      .countdown-timer-{{ section.id }}-{{ block.id }} {\n                        display: flex;\n                        justify-content: center;\n                        gap: 0px;\n                      }\n                      @media (min-width: 750px) {\n                        .countdown-timer-{{ section.id }}-{{ block.id }} {\n                           gap: 0px;\n                        }\n                        .timer-div-{{ section.id }} {\n                          gap:3rem;\n                        }\n                      }\n                      .countdown-timer-{{ section.id }}-{{ block.id }} .time-block {\n                        position: relative;\n                        border-radius: 12px;\n                        /*padding: 20px;*/\n                        padding: 0 0.5rem;\n                      }\n                      @media (min-width: 750px) {\n                        .countdown-timer-{{ section.id }}-{{ block.id }} .time-block {\n                          padding: 0 0.75rem;\n                        }\n                      }\n                      .countdown-timer-{{ section.id }}-{{ block.id }} .time-block__num,\n                      .countdown-timer-{{ section.id }}-{{ block.id }} .time-block__unit {\n                        display: block;\n                        text-align: center;\n                      }\n                      .countdown-timer-{{ section.id }}-{{ block.id }} .time-block__num {\n                        font-size: {{ block.settings.font_size_number | times: 0.85 | round: 0  }}px;\n                        font-weight: 700;\n                        line-height: 1;\n                      }\n                      .countdown-timer-{{ section.id }}-{{ block.id }} .time-block__unit {\n                        margin-top: 3px;\n                        font-size: {{ block.settings.font_size_text | times: 0.85 | round: 0 }}px;\n                      }\n                      @media (min-width: 750px) {\n                        .countdown-timer-{{ section.id }}-{{ block.id }} .time-block__unit {\n                          font-size: {{ block.settings.font_size_text }}px;\n                        }\n                        .countdown-timer-{{ section.id }}-{{ block.id }} .time-block__num {\n                          font-size: {{ block.settings.font_size_number }}px;\n                        }\n                        .countdown-timer-{{ section.id }}-{{ block.id }} .time-colon {\n                          font-weight: 700;\n                          font-size: {{ block.settings.font_size_number }}px;\n                        }\n                      }\n                      .countdown-timer-{{ section.id }}-{{ block.id }} .time-divier {\n                        position: relative;\n                        width: 2px;\n                        height: 40px;\n                        background-color: var(--color);\n                      }\n                      .countdown-timer-{{ section.id }}-{{ block.id }} .time-colon {\n                        font-weight: 700;\n                        font-size: {{ block.settings.font_size_number | times: 0.85 | round: 0}}px;\n                      }\n                    </style>\n\n                    <div\n                      class=\"countdown-timer-{{ section.id }}-{{ block.id }}\"\n                      {{ block.shopify_attributes }}\n                      style=\"\n                        color: {{ block.settings.color }};\n                        --color: {{ block.settings.color }};\n                      \"\n                    >\n                      <div class=\"time-block\">\n                        <span class=\"time-block__num js-timer-days\">00</span>\n                        <span class=\"time-block__unit\">{{ section.settings.days_text }}</span>\n                      </div>\n                      <span class=\"time-colon\">:</span>\n                      <div class=\"time-block\">\n                        <span class=\"time-block__num js-timer-hours\">00</span>\n                        <span class=\"time-block__unit\">{{ section.settings.hours_text }}</span>\n                      </div>\n                      <span class=\"time-colon\">:</span>\n                      <div class=\"time-block\">\n                        <span class=\"time-block__num js-timer-minutes\">00</span>\n                        <span class=\"time-block__unit\">{{ section.settings.mins_text }}</span>\n                      </div>\n                      <span class=\"time-colon\">:</span>\n                      <div class=\"time-block\">\n                        <span class=\"time-block__num js-timer-seconds\">00</span>\n                        <span class=\"time-block__unit\">{{ section.settings.seconds_text }}</span>\n                      </div>\n                    </div>\n\n                    <script type=\"text/javascript\">\n\n                      (function () {\n                        function startTimer() {\n                          const second = 1000,\n                            minute = second * 60,\n                            hour = minute * 60,\n                            day = hour * 24,\n                            wrapper = document.querySelector(\n                              '.countdown-timer-{{ section.id }}-{{ block.id }}'\n                            );\n                      \n                          const targetDate = new Date(Date.UTC(\n                            parseInt('{{ block.settings.year }}', 10),\n                            parseInt('{{ block.settings.month }}', 10) - 1,\n                            parseInt('{{ block.settings.day }}', 10),\n                            parseInt('{{ block.settings.hour }}', 10),\n                            parseInt('{{ block.settings.minute }}', 10),\n                            0\n                          ));\n                          \n                          const countDown = targetDate.getTime();\n                          console.log('Announcement bar timer end date:', new Date(countDown).toISOString());\n                      \n                          const interval = setInterval(function () {\n                            let now = Date.now(),\n                              distance = countDown - now,\n                              days = Math.floor(distance / day),\n                              hours = Math.floor((distance % day) / hour),\n                              minutes = Math.floor((distance % hour) / minute),\n                              seconds = Math.floor((distance % minute) / second);\n                      \n                            (wrapper.querySelector('.js-timer-days').innerText =\n                              (days < 10 ? '0' : '') + days),\n                              (wrapper.querySelector('.js-timer-hours').innerText = (\n                                '0' + hours\n                              ).slice(-2)\n                              ),\n                              (wrapper.querySelector('.js-timer-minutes').innerText = (\n                                '0' + minutes\n                              ).slice(-2)),\n                              (wrapper.querySelector('.js-timer-seconds').innerText = (\n                                '0' + seconds\n                              ).slice(-2));\n                      \n                            if (distance < 0) {\n                              wrapper.querySelector('.js-timer-days').innerText = '00';\n                              wrapper.querySelector('.js-timer-hours').innerText = '00';\n                              wrapper.querySelector('.js-timer-minutes').innerText = '00';\n                              wrapper.querySelector('.js-timer-seconds').innerText = '00';\n                              {% if block.settings.hide_timer_on_completed %}\n                                wrapper.style.display = 'none';\n                              {% endif %}\n                              clearInterval(interval);\n                            }\n                          }, second);\n                      \n                          document.addEventListener('shopify:section:unload', function (event) {\n                            if (event.detail.sectionId === '{{ section.id }}') clearInterval(interval);\n                          });\n                        }\n                      \n                        startTimer();\n                        if (window.Shopify && Shopify.designMode) {\n                          document.addEventListener('shopify:section:load', function (event) {\n                            if (event.detail.sectionId === '{{ section.id }}') {\n                              startTimer();\n                            }\n                          });\n                        }\n                      })();\n                    </script>\n\n                    <style>\n                      .countdown-banner-button-{{ section.id }}-{{ block.id }} {\n                        padding: 16px 12px;\n                        text-decoration: none;\n                      }\n                      @media (min-width: 750px) {\n                        .countdown-banner-button-{{ section.id }}-{{ block.id }} {\n                          padding: 16px 25px;\n                        }\n                      }\n                    </style>\n                    {% for button_block in section.blocks %}\n                      {% if button_block.type == 'button' and button_block.settings.button_text != blank %}\n                        <a\n                          href=\"{{ button_block.settings.button_link }}\"\n                          class=\"countdown-banner-button-{{ section.id }}-{{ block.id }}\"\n                          style=\"\n                            color: {{ button_block.settings.button_color }};\n                            background-color: {{ button_block.settings.background_color }};\n                            border-radius: {{ button_block.settings.border_radius }}px;\n                            font-size: {{ button_block.settings.font_size }}px;\n                            font-weight:700;\n                            border: {{button_block.settings.button_border_thickness}}px {{button_block.settings.button_border_color}} solid;\n                          \"\n                        >\n                          {{ button_block.settings.button_text }}\n                        </a>\n                      {% endif %}\n                    {% endfor %}\n                  </div>\n                {% else %}\n\n              {% endcase %}\n            {% endfor %}\n          </div>\n        </div>\n      </div>\n\n      {% if section.settings.use_cross %}\n      {% comment %} Close button: {% endcomment %}\n      <style>\n        @media (min-width: 750px) {\n          #close-button-{{ section.id }} {\n            padding: 0 10px 0 0;\n          }\n        }\n      </style>\n      <div\n        style=\"\n          position: absolute;\n          top: 50%;\n          right: 0;\n          transform: translateY(-50%);\n          padding: 0 5px 0 0;\n          color: gray;\n          cursor: pointer;\n        \"\n        id=\"close-button-{{ section.id }}\"\n      >\n        <svg\n          stroke=\"currentColor\"\n          fill=\"currentColor\"\n          stroke-width=\"0\"\n          viewBox=\"0 0 512 512\"\n          height=\"1em\"\n          width=\"1em\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path d=\"M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 136.798 405 256 285.798 375.202 405 405 375.202 285.798 256z\"></path>\n        </svg>\n      </div>\n      <script>\n        document\n          .getElementById('close-button-{{ section.id }}')\n          .addEventListener('click', function () {\n            document.getElementById(\n              'countdown-banner-{{ section.id }}-wrapper'\n            ).style.display = 'none';\n          });\n      </script>\n      {% endif %}\n    </div>\n  </div>\n</template>\n\n<div id=\"countdown-default-target-{{ section.id }}\"></div>\n\n<script>\n  (function () {\n    function moreLoadProductForm() {\n      {% if section.settings.target_selector != blank %}\n        var productForm = document.querySelector('{{ section.settings.target_selector }}');\n      {% else %}\n        var productForm = document.querySelector('#countdown-default-target-{{ section.id }}');\n      {% endif %}\n\n      const templateContent = document.querySelector(\n        '#countdown-timer-{{ section.id }}'\n      ).content;\n\n      productForm.insertAdjacentElement(\n        'beforebegin',\n        templateContent.firstElementChild\n      );\n    }\n    window.addEventListener('DOMContentLoaded', moreLoadProductForm);\n\n    // if (window.Shopify && Shopify.designMode) {\n    //   window.addEventListener('shopify:section:load', moreLoadProductForm);\n    // }\n  })();\n</script>",
  "variables": {
    "target_selector": {
      "type": "text",
      "default": ".header, .pageheader, .section-header, #announcement, .toolbar, .header__wrapper, .onboarding-header",
      "label": "CSS selector for the target element",
      "description": "The timer will be inserted above target element. If you leave this blank, the timer will display where you drag it."
    },
    "use_cross": {
      "type": "text",
      "default": "false",
      "label": "Use close/hide section button",
      "description": "Use close/hide section button"
    },
    "days_text": {
      "type": "text",
      "default": "Days",
      "label": "Days text",
      "description": "Days text"
    },
    "hours_text": {
      "type": "text",
      "default": "Hrs",
      "label": "Hours text",
      "description": "Hours text"
    },
    "mins_text": {
      "type": "text",
      "default": "Mins",
      "label": "Minutes text",
      "description": "Minutes text"
    },
    "seconds_text": {
      "type": "text",
      "default": "Secs",
      "label": "Seconds text",
      "description": "Seconds text"
    },
    "background-color": {
      "type": "color",
      "default": "#000000",
      "label": "Background",
      "description": "Background"
    }
  }
}